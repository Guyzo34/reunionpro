{"version":3,"file":"daily-react.esm.js","sources":["../src/DailyContext.tsx","../src/hooks/useDaily.ts","../src/DailyEventContext.tsx","../src/hooks/useDailyEvent.ts","../src/lib/constants.ts","../src/hooks/useParticipantProperty.ts","../src/hooks/useThrottledDailyEvent.ts","../src/lib/customDeepEqual.ts","../src/lib/recoil-custom.ts","../src/utils/getParticipantPaths.ts","../src/utils/resolveParticipantPaths.ts","../src/DailyParticipants.tsx","../src/hooks/useLocalSessionId.ts","../src/hooks/useActiveSpeakerId.ts","../src/utils/isTrackOff.ts","../src/hooks/useParticipantIds.ts","../src/hooks/useScreenShare.ts","../src/hooks/useMediaTrack.ts","../src/hooks/useMergedRef.ts","../src/components/DailyAudioTrack.tsx","../src/components/DailyAudio.tsx","../src/components/DailyVideo.tsx","../src/DailyDevicesContext.tsx","../src/DailyDevices.tsx","../src/DailyLiveStreaming.tsx","../src/DailyMeeting.tsx","../src/DailyNetwork.tsx","../src/DailyRecordings.tsx","../src/hooks/useMeetingState.ts","../src/DailyRoom.tsx","../src/DailyTranscriptions.tsx","../src/hooks/useCallInstance.ts","../src/hooks/useCallObject.ts","../src/DailyProvider.tsx","../src/hooks/useParticipant.ts","../src/hooks/useActiveParticipant.ts","../src/hooks/useAppMessage.ts","../src/lib/inlineAudioWorklet.ts","../src/hooks/useAudioLevel.ts","../src/hooks/useAudioTrack.ts","../src/hooks/useCallFrame.ts","../src/hooks/useCPULoad.ts","../src/hooks/useDailyError.ts","../src/hooks/useDevices.ts","../src/hooks/useInputSettings.ts","../src/hooks/useLiveStreaming.ts","../src/hooks/useLocalParticipant.ts","../src/hooks/useMeetingSessionState.ts","../src/hooks/useNetwork.ts","../src/hooks/useParticipantCounts.ts","../src/hooks/usePermissions.ts","../src/hooks/useReceiveSettings.ts","../src/hooks/useRecording.ts","../src/hooks/useRoom.ts","../src/hooks/useRoomExp.ts","../src/hooks/useScreenAudioTrack.ts","../src/hooks/useScreenVideoTrack.ts","../src/hooks/useSendSettings.ts","../src/hooks/useTranscription.ts","../src/hooks/useVideoTrack.ts","../src/hooks/useWaitingParticipants.ts"],"sourcesContent":["import { DailyCall } from '@daily-co/daily-js';\nimport { createContext } from 'react';\n\nexport const DailyContext = createContext<DailyCall | null>(null);\n","import { useContext, useDebugValue } from 'react';\n\nimport { DailyContext } from '../DailyContext';\n\n/**\n * Returns callObject instance passed to or created by closest <DailyProvider>.\n */\nexport const useDaily = () => {\n  const daily = useContext(DailyContext);\n  useDebugValue(daily);\n  return daily;\n};\n","import { DailyEvent } from '@daily-co/daily-js';\nimport { createContext } from 'react';\n\ninterface EventContextValue {\n  on(ev: DailyEvent, callback: Function, key: number): void;\n  off(ev: DailyEvent, key: number): void;\n}\n\nexport const DailyEventContext = createContext<EventContextValue>({\n  on: () => {},\n  off: () => {},\n});\n","import { DailyEvent, DailyEventObject } from '@daily-co/daily-js';\nimport {\n  useContext,\n  useDebugValue,\n  useEffect,\n  useMemo,\n  useRef,\n  useState,\n} from 'react';\n\nimport { DailyEventContext } from '../DailyEventContext';\n\ntype EventCallback<T extends DailyEvent> = (event: DailyEventObject<T>) => void;\n\nlet uniqueCounter = 0;\nexport const getUnique = () => uniqueCounter++;\n\n/**\n * Sets up a daily event listener using [on](https://docs.daily.co/reference/daily-js/instance-methods/on) method.\n * When this hook is unmounted the event listener is unregistered using [off](https://docs.daily.co/reference/daily-js/instance-methods/off).\n *\n * Warning: callback has to be a memoized reference (e.g. via [useCallback](https://reactjs.org/docs/hooks-reference.html#usecallback)).\n * Otherwise a console error might be thrown indicating a re-render loop issue.\n *\n * @param ev The DailyEvent to register.\n * @param callback A memoized callback reference to run when the event is emitted.\n */\nexport const useDailyEvent = <T extends DailyEvent>(\n  ev: T,\n  callback: EventCallback<T>\n) => {\n  const { off, on } = useContext(DailyEventContext);\n  const [isBlocked, setIsBlocked] = useState(false);\n  const reassignCount = useRef<number>(0);\n\n  const eventId = useMemo(() => getUnique(), []);\n\n  useEffect(() => {\n    if (!ev || isBlocked) return;\n    /**\n     * Check if callback has been reassigned often enough without hitting the 50ms timeout.\n     */\n    if (reassignCount.current > 100000) {\n      console.error(\n        `useDailyEvent called with potentially non-memoized event callback or due to too many re-renders.\n        Memoize using useCallback to avoid re-render loop or reduce the amount of state transitions the callback depends on.\n        Passed callback for '${ev}' event is NOT registered.`,\n        callback\n      );\n      setIsBlocked(true);\n      return;\n    }\n    reassignCount.current++;\n    const timeout = setTimeout(() => {\n      reassignCount.current = 0;\n    }, 50);\n    on(ev, callback, eventId);\n    return () => {\n      clearTimeout(timeout);\n      off(ev, eventId);\n    };\n  }, [callback, ev, eventId, isBlocked, off, on]);\n\n  useDebugValue({\n    event: ev,\n    eventId,\n    isBlocked,\n    callback,\n  });\n};\n","export const RECOIL_PREFIX = 'daily-react-';\n","import { useDebugValue } from 'react';\nimport { atomFamily, selectorFamily, useRecoilValue } from 'recoil';\n\nimport { ExtendedDailyParticipant } from '../DailyParticipants';\nimport { RECOIL_PREFIX } from '../lib/constants';\nimport type { NumericKeys } from '../types/NumericKeys';\nimport type { Paths } from '../types/paths';\nimport type { PathValue } from '../types/pathValue';\n\ntype PropertyType = {\n  id: string;\n  property: Paths<ExtendedDailyParticipant>;\n};\n\ntype PropertiesType = {\n  id: string;\n  properties: Paths<ExtendedDailyParticipant>[];\n};\n\n/**\n * Stores all property paths for a given participant.\n */\nexport const participantPropertyPathsState = atomFamily<\n  Paths<ExtendedDailyParticipant>[],\n  string\n>({\n  key: RECOIL_PREFIX + 'participant-property-paths',\n  default: [],\n});\n\n/**\n * Stores resolved values for each participant and property path.\n */\nexport const participantPropertyState = atomFamily<any, PropertyType>({\n  key: RECOIL_PREFIX + 'participant-property',\n  default: null,\n  dangerouslyAllowMutability: true, // daily-js mutates track props (_managedByDaily, etc)\n});\n\n/**\n * Stores resolved values for each participant and property path.\n */\nexport const participantPropertiesState = selectorFamily<any, PropertiesType>({\n  key: RECOIL_PREFIX + 'participant-properties',\n  get:\n    ({ id, properties }) =>\n    ({ get }) => {\n      return properties.map((path) =>\n        get(participantPropertyState({ id, property: path }))\n      );\n    },\n  dangerouslyAllowMutability: true, // daily-js mutates track props (_managedByDaily, etc)\n});\n\ntype UseParticipantPropertyReturnType<\n  T extends ExtendedDailyParticipant,\n  P extends Paths<T> | Paths<T>[]\n> = P extends Paths<T>[]\n  ? { [K in keyof P]: K extends NumericKeys ? PathValue<T, P[K]> : unknown }\n  : P extends Paths<T>\n  ? PathValue<T, P>\n  : never;\n\n/**\n * Returns a participant's property that you subscribe to.\n * @param participantId The participant's session_id.\n * @param propertyPaths the array of participant property that you want to subscribe to.\n */\nexport const useParticipantProperty = <\n  T extends ExtendedDailyParticipant = ExtendedDailyParticipant,\n  P extends Paths<T> | [Paths<T>, ...Paths<T>[]] =\n    | Paths<T>\n    | [Paths<T>, ...Paths<T>[]]\n>(\n  participantId: string,\n  propertyPaths: P\n): UseParticipantPropertyReturnType<T, P> => {\n  const properties = useRecoilValue(\n    Array.isArray(propertyPaths)\n      ? participantPropertiesState({\n          id: participantId,\n          properties: propertyPaths as Paths<ExtendedDailyParticipant>[],\n        })\n      : participantPropertyState({\n          id: participantId,\n          property: propertyPaths as Paths<ExtendedDailyParticipant>,\n        })\n  );\n\n  useDebugValue(\n    Array.isArray(propertyPaths)\n      ? propertyPaths.reduce(\n          (o: Record<any, any>, path: Paths<T>, i: number) => {\n            o[path] = properties[i];\n            return o;\n          },\n          {}\n        )\n      : {\n          [propertyPaths as any]: properties,\n        }\n  );\n\n  return properties;\n};\n","import { DailyEvent, DailyEventObject } from '@daily-co/daily-js';\nimport throttle from 'lodash.throttle';\nimport {\n  useCallback,\n  useContext,\n  useDebugValue,\n  useEffect,\n  useMemo,\n  useRef,\n} from 'react';\n\nimport { DailyEventContext } from '../DailyEventContext';\nimport { getUnique, useDailyEvent } from './useDailyEvent';\n\ntype EnsureArray<T> = T extends DailyEvent ? [T] : T;\n\ntype EventObjectsFor<T> = EnsureArray<T> extends (infer U)[]\n  ? U extends DailyEvent\n    ? DailyEventObject<U>\n    : never\n  : never;\n\ntype EventCallback<T extends DailyEvent | DailyEvent[]> = (\n  events: EventObjectsFor<T>[]\n) => void;\n\n/**\n * Sets up a throttled daily event listener using [on](https://docs.daily.co/reference/daily-js/instance-methods/on) method.\n * When this hook is unmounted the event listener is unregistered using [off](https://docs.daily.co/reference/daily-js/instance-methods/off).\n *\n * In comparison to useDailyEvent the callback passed here will be called with an array of event objects.\n *\n * You can pass an array of DailyEvents to register multiple daily events with a single callback handler.\n * The events returned in the callback parameter are guaranteed to be in the same order as they were emitted.\n *\n * @param ev The DailyEvent to register or an array of DailyEvent to register.\n * @param callback A memoized callback reference to run when throttled events are emitted.\n * @param throttleTimeout The minimum waiting time until the callback is called again. Default: 100\n */\nexport const useThrottledDailyEvent = <T extends DailyEvent>(\n  ev: T | T[],\n  callback: EventCallback<EnsureArray<T>>,\n  throttleTimeout = 500\n) => {\n  const { off, on } = useContext(DailyEventContext);\n  const eventId = useMemo(() => {\n    if (Array.isArray(ev))\n      return ev.reduce<Record<string, number>>((r, e) => {\n        r[e] = getUnique();\n        return r;\n      }, {});\n    return { [ev]: getUnique() };\n  }, [ev]);\n\n  const throttledEvents = useRef<EventObjectsFor<T>[]>([]);\n\n  useDailyEvent(\n    'call-instance-destroyed',\n    useCallback(() => {\n      throttledEvents.current.length = 0;\n    }, [])\n  );\n\n  const emitEvents = useMemo(\n    () =>\n      throttle(\n        () => {\n          if (throttledEvents.current.length === 0) return;\n          callback(throttledEvents.current);\n          throttledEvents.current.length = 0;\n        },\n        throttleTimeout,\n        {\n          trailing: true,\n        }\n      ),\n    [callback, throttleTimeout]\n  );\n\n  useEffect(() => {\n    if (!ev) return;\n    const addEvent = (ev: DailyEventObject) => {\n      throttledEvents.current.push(ev);\n      emitEvents();\n    };\n    if (Array.isArray(ev)) {\n      ev.forEach((e) => on(e, addEvent, eventId[e]));\n    } else {\n      on(ev, addEvent, eventId[ev]);\n    }\n    return () => {\n      if (Array.isArray(ev)) {\n        ev.forEach((e) => off(e, eventId[e]));\n      } else {\n        off(ev, eventId[ev]);\n      }\n    };\n  }, [emitEvents, ev, eventId, off, on]);\n\n  useDebugValue({\n    event: ev,\n    eventId,\n  });\n};\n","/**\n * Compares two variables for deep equality.\n * Gracefully handles equality checks on MediaStreamTracks by comparing their ids.\n */\nexport function customDeepEqual(a: any, b: any): boolean {\n  if (a === b) return true;\n\n  // Handle special case for MediaStream\n  if (a instanceof MediaStream && b instanceof MediaStream) {\n    return (\n      a.id === b.id &&\n      a.active === b.active &&\n      a.getTracks().length === b.getTracks().length &&\n      a\n        .getTracks()\n        .every((track, idx) => customDeepEqual(track, b.getTracks()[idx]))\n    );\n  }\n\n  // Handle special case for MediaStreamTrack\n  if (a instanceof MediaStreamTrack && b instanceof MediaStreamTrack) {\n    return a.id === b.id && a.kind === b.kind && a.readyState === b.readyState;\n  }\n\n  // Handle special case for Date\n  if (a instanceof Date && b instanceof Date) {\n    return a.getTime() === b.getTime();\n  }\n\n  // Handle special case for RegExp\n  if (a instanceof RegExp && b instanceof RegExp) {\n    return a.source === b.source && a.flags === b.flags;\n  }\n\n  // Handle special case for Set\n  if (a instanceof Set && b instanceof Set) {\n    if (a.size !== b.size) {\n      return false;\n    }\n\n    for (const value of a.values()) {\n      if (!b.has(value)) {\n        return false;\n      }\n    }\n\n    return true;\n  }\n\n  // Handle special case for Map\n  if (a instanceof Map && b instanceof Map) {\n    if (a.size !== b.size) {\n      return false;\n    }\n    for (const [key, value] of a.entries()) {\n      if (!b.has(key)) {\n        return false;\n      }\n      if (!customDeepEqual(value, b.get(key))) {\n        return false;\n      }\n    }\n\n    return true;\n  }\n\n  // If a or b are not objects or null, they can't be deeply equal\n  if (\n    typeof a !== 'object' ||\n    a === null ||\n    typeof b !== 'object' ||\n    b === null\n  ) {\n    return false;\n  }\n\n  // Get the keys of a and b. This handles both arrays and objects, since arrays are technically objects.\n  let keysA = Object.keys(a);\n  let keysB = Object.keys(b);\n\n  // If the number of keys are different, the objects are not equal\n  if (keysA.length !== keysB.length) return false;\n\n  for (let key of keysA) {\n    if (\n      // If key exists in a, but not in b -> not equal\n      !(key in b) ||\n      // Both keys exist in both object -> run nested equality check\n      !customDeepEqual(a[key], b[key])\n    )\n      return false;\n  }\n\n  // All keys and values match -> the objects are deeply equal\n  return true;\n}\n","import {\n  ReadOnlySelectorFamilyOptions,\n  ReadOnlySelectorOptions,\n  RecoilValueReadOnly,\n  selector,\n  selectorFamily,\n  SerializableParam,\n} from 'recoil';\n\ninterface EqualSelectorOptions<T>\n  extends Pick<ReadOnlySelectorOptions<T>, 'key' | 'get'> {\n  equals: (a: T, b: T) => boolean;\n}\n\n/**\n * Same API as [selector](https://recoiljs.org/docs/api-reference/core/selector), but with an additional `equals` key.\n * Allows to run custom equality checks before returning a new calculated value.\n * Use this, when returning non-primitive types from state.\n * Resource: https://github.com/facebookexperimental/Recoil/issues/1416#issuecomment-1044953271\n */\nexport function equalSelector<T>(\n  options: EqualSelectorOptions<T>\n): RecoilValueReadOnly<T> {\n  const inner = selector({\n    key: `${options.key}_inner`,\n    get: options.get,\n  });\n\n  let prior: T | undefined;\n\n  return selector({\n    key: options.key,\n    get: ({ get }) => {\n      const latest = get(inner);\n      if (prior != null && options.equals(latest, prior)) {\n        return prior;\n      }\n      prior = latest;\n      return latest as T;\n    },\n  });\n}\n\ninterface EqualSelectorFamilyOptions<T, P extends SerializableParam>\n  extends Pick<ReadOnlySelectorFamilyOptions<T, P>, 'key' | 'get'> {\n  equals: (a: T, b: T) => boolean;\n}\n\n/**\n * Same API as [selectorFamily](https://recoiljs.org/docs/api-reference/utils/selectorFamily/), but with an additional `equals` key.\n * Allows to run custom equality checks before returning a new calculated value.\n * Use this, when returning non-primitive types from state.\n * Resource: https://github.com/facebookexperimental/Recoil/issues/1416#issuecomment-1168603409\n */\nexport function equalSelectorFamily<T, P extends SerializableParam>(\n  options: EqualSelectorFamilyOptions<T, P>\n) {\n  const inner = selectorFamily<T, P>({\n    key: `${options.key}_inner`,\n    get: options.get,\n  });\n\n  const priorValues: Map<P, T | undefined> = new Map();\n\n  return selectorFamily<T, P>({\n    ...options,\n    key: options.key,\n    get:\n      (param: P) =>\n      ({ get }) => {\n        const latest = get(inner(param));\n        const prior = priorValues.get(param);\n        if (prior != null && options.equals(latest, prior)) {\n          return prior;\n        }\n        priorValues.set(param, latest);\n        return latest;\n      },\n  });\n}\n","import { ExtendedDailyParticipant } from '../DailyParticipants';\nimport { Paths } from '../types/paths';\n\n/**\n * Returns all property paths for an object.\n */\nconst getPaths = (o: Record<any, any>, currentPath = ''): string[] => {\n  if (typeof o !== 'object' || o === null) {\n    return [currentPath];\n  }\n\n  const paths = [];\n  for (const key in o) {\n    if (Object.prototype.hasOwnProperty.call(o, key)) {\n      const newPath = currentPath ? `${currentPath}.${key}` : key;\n      paths.push(newPath, ...getPaths(o[key], newPath));\n    }\n  }\n\n  return paths;\n};\n\n/**\n * Returns all property paths for a given participant object.\n */\nexport const getParticipantPaths = (p: ExtendedDailyParticipant) => {\n  return getPaths(p) as Paths<ExtendedDailyParticipant>[];\n};\n","import { ExtendedDailyParticipant } from '../DailyParticipants';\nimport type { NumericKeys } from '../types/NumericKeys';\nimport type { Paths } from '../types/paths';\nimport type { PathValue } from '../types/pathValue';\n\nconst resolvePath = <T extends ExtendedDailyParticipant, P extends Paths<T>>(\n  participant: T | null,\n  path: P\n): PathValue<T, P> => {\n  return String(path)\n    .split('.')\n    .filter((key) => key.length)\n    .reduce((p: any, key) => p && p[key], participant);\n};\n\ntype ResolveParticipantPathsReturnType<\n  T extends ExtendedDailyParticipant,\n  P extends Paths<T>[]\n> = { [K in keyof P]: K extends NumericKeys ? PathValue<T, P[K]> : never };\n\nexport const resolveParticipantPaths = <\n  T extends ExtendedDailyParticipant,\n  P extends Paths<T>[]\n>(\n  participant: T | null,\n  paths: P\n): ResolveParticipantPathsReturnType<T, P> => {\n  return paths.map((path) =>\n    resolvePath(participant, path)\n  ) as ResolveParticipantPathsReturnType<T, P>;\n};\n","import {\n  DailyParticipant,\n  DailyParticipantsObject,\n  DailyParticipantTracks,\n  DailyWaitingParticipant,\n} from '@daily-co/daily-js';\nimport React, { useCallback, useEffect, useState } from 'react';\nimport { atom, atomFamily, selector, useRecoilCallback } from 'recoil';\n\nimport { useDaily } from './hooks/useDaily';\nimport { useDailyEvent } from './hooks/useDailyEvent';\nimport {\n  participantPropertyPathsState,\n  participantPropertyState,\n} from './hooks/useParticipantProperty';\nimport { useThrottledDailyEvent } from './hooks/useThrottledDailyEvent';\nimport { RECOIL_PREFIX } from './lib/constants';\nimport { customDeepEqual } from './lib/customDeepEqual';\nimport { equalSelector } from './lib/recoil-custom';\nimport { getParticipantPaths } from './utils/getParticipantPaths';\nimport { resolveParticipantPaths } from './utils/resolveParticipantPaths';\n\n/**\n * Extends DailyParticipant with convenient additional properties.\n * The `tracks` object needs to omit custom track keys, otherwise\n * autocomplete for `tracks` in useParticipantProperty doesn't work.\n */\nexport interface ExtendedDailyParticipant\n  extends Omit<DailyParticipant, 'tracks'> {\n  last_active?: Date;\n  tracks: DailyParticipantTracks;\n}\n\n/**\n * Stores the most recent peerId as reported from [active-speaker-change](https://docs.daily.co/reference/daily-js/events/meeting-events#active-speaker-change) event.\n */\nexport const activeIdState = atom<string | null>({\n  key: RECOIL_PREFIX + 'active-id',\n  default: null,\n});\n\nexport const localIdState = atom<string>({\n  key: RECOIL_PREFIX + 'local-id',\n  default: '',\n});\n\nexport const localJoinDateState = atom<Date | null>({\n  key: RECOIL_PREFIX + 'local-joined-date',\n  default: null,\n});\n\nexport const participantIdsState = atom<string[]>({\n  key: RECOIL_PREFIX + 'participant-ids',\n  default: [],\n});\n\nexport const participantState = atomFamily<\n  ExtendedDailyParticipant | null,\n  string\n>({\n  key: RECOIL_PREFIX + 'participant-state',\n  default: null,\n  dangerouslyAllowMutability: true, // daily-js mutates track props (_managedByDaily, etc)\n});\n\nexport const participantsState = selector<ExtendedDailyParticipant[]>({\n  key: RECOIL_PREFIX + 'participants',\n  get: ({ get }) => {\n    const ids = get(participantIdsState);\n    const participants = ids\n      .map((id) => get(participantState(id)))\n      .filter(Boolean) as ExtendedDailyParticipant[];\n    return participants;\n  },\n  dangerouslyAllowMutability: true, // daily-js mutates track props (_managedByDaily, etc)\n});\n\n/**\n * Holds all participants in the waiting room.\n */\nexport const waitingParticipantsState = atom<string[]>({\n  key: RECOIL_PREFIX + 'waiting-participants',\n  default: [],\n});\n\n/**\n * Holds each invidiual waiting participant's information.\n */\nexport const waitingParticipantState = atomFamily<\n  DailyWaitingParticipant,\n  string\n>({\n  key: RECOIL_PREFIX + 'waiting-participant',\n  default: {\n    awaitingAccess: {\n      level: 'full',\n    },\n    id: '',\n    name: '',\n  },\n});\n\n/**\n * Returns all waiting participant objects in an array.\n */\nexport const allWaitingParticipantsSelector = equalSelector({\n  key: RECOIL_PREFIX + 'waitingParticipantsSelector',\n  equals: customDeepEqual,\n  get: ({ get }) => {\n    const ids = get(waitingParticipantsState);\n    return ids.map((id) => get(waitingParticipantState(id)));\n  },\n});\n\nexport const DailyParticipants: React.FC<React.PropsWithChildren<{}>> = ({\n  children,\n}) => {\n  const daily = useDaily();\n  const [initialized, setInitialized] = useState(false);\n\n  const initParticipants = useRecoilCallback(\n    ({ transact_UNSTABLE }) =>\n      (participants: DailyParticipantsObject) => {\n        transact_UNSTABLE(({ set }) => {\n          set(localIdState, participants.local.session_id);\n          const participantsArray = Object.values(participants);\n          const ids = participantsArray.map((p) => p.session_id);\n          set(participantIdsState, ids);\n          participantsArray.forEach((p) => {\n            set(participantState(p.session_id), p);\n            const paths = getParticipantPaths(p);\n            // Set list of property paths\n            set(participantPropertyPathsState(p.session_id), paths);\n            // Set all property path values\n            paths.forEach((property) => {\n              const [value] = resolveParticipantPaths(\n                p as ExtendedDailyParticipant,\n                [property]\n              );\n              set(\n                participantPropertyState({\n                  id: p.session_id,\n                  property,\n                }),\n                value\n              );\n            });\n          });\n          setInitialized(true);\n        });\n      },\n    []\n  );\n  /**\n   * Initialize participants state based on daily.participants().\n   * Retries every 100ms to initialize the state, until daily is ready.\n   */\n  useEffect(() => {\n    if (!daily || initialized) return;\n    const interval = setInterval(() => {\n      const participants = daily.participants();\n      if (!('local' in participants)) return;\n      initParticipants(participants);\n      clearInterval(interval);\n    }, 100);\n    return () => {\n      clearInterval(interval);\n    };\n  }, [daily, initialized, initParticipants]);\n  const handleInitEvent = useCallback(() => {\n    if (!daily) return;\n    const participants = daily?.participants();\n    if (!participants.local) return;\n    initParticipants(participants);\n  }, [daily, initParticipants]);\n  useDailyEvent('started-camera', handleInitEvent);\n  useDailyEvent('access-state-updated', handleInitEvent);\n  useDailyEvent(\n    'joining-meeting',\n    useRecoilCallback(\n      ({ set }) =>\n        () => {\n          set(localJoinDateState, new Date());\n          handleInitEvent();\n        },\n      [handleInitEvent]\n    )\n  );\n  useDailyEvent(\n    'joined-meeting',\n    useCallback(\n      (ev) => {\n        initParticipants(ev.participants);\n      },\n      [initParticipants]\n    )\n  );\n\n  useThrottledDailyEvent(\n    [\n      'active-speaker-change',\n      'call-instance-destroyed',\n      'left-meeting',\n      'participant-joined',\n      'participant-updated',\n      'participant-left',\n    ],\n    useRecoilCallback(\n      ({ transact_UNSTABLE }) =>\n        (evts) => {\n          transact_UNSTABLE(({ get, reset, set }) => {\n            evts.forEach((ev) => {\n              switch (ev.action) {\n                case 'active-speaker-change': {\n                  set(activeIdState, ev.activeSpeaker.peerId);\n                  set(participantState(ev.activeSpeaker.peerId), (prev) => {\n                    if (!prev) return null;\n                    return {\n                      ...prev,\n                      last_active: new Date(),\n                    };\n                  });\n                  break;\n                }\n                case 'participant-joined': {\n                  // Update list of ids\n                  set(participantIdsState, (prevIds) =>\n                    prevIds.includes(ev.participant.session_id)\n                      ? prevIds\n                      : [...prevIds, ev.participant.session_id]\n                  );\n                  // Store entire object\n                  set(\n                    participantState(ev.participant.session_id),\n                    ev.participant\n                  );\n\n                  const paths = getParticipantPaths(ev.participant);\n                  // Set list of property paths\n                  set(\n                    participantPropertyPathsState(ev.participant.session_id),\n                    paths\n                  );\n                  // Set all property path values\n                  paths.forEach((property) => {\n                    const [value] = resolveParticipantPaths(\n                      ev.participant as ExtendedDailyParticipant,\n                      [property]\n                    );\n                    set(\n                      participantPropertyState({\n                        id: ev.participant.session_id,\n                        property,\n                      }),\n                      value\n                    );\n                  });\n                  break;\n                }\n                case 'participant-updated': {\n                  // Update entire object\n                  set(participantState(ev.participant.session_id), (prev) => ({\n                    ...prev,\n                    ...ev.participant,\n                  }));\n                  // Update local session_id\n                  if (ev.participant.local) {\n                    set(localIdState, (prevId) =>\n                      prevId !== ev.participant.session_id\n                        ? ev.participant.session_id\n                        : prevId\n                    );\n                  }\n\n                  const paths = getParticipantPaths(ev.participant);\n                  const oldPaths = get(\n                    participantPropertyPathsState(ev.participant.session_id)\n                  );\n                  // Set list of property paths\n                  set(\n                    participantPropertyPathsState(ev.participant.session_id),\n                    (prev) => (customDeepEqual(prev, paths) ? prev : paths)\n                  );\n                  // Reset old path values\n                  oldPaths\n                    .filter((p) => !paths.includes(p))\n                    .forEach((property) => {\n                      reset(\n                        participantPropertyState({\n                          id: ev.participant.session_id,\n                          property,\n                        })\n                      );\n                    });\n                  // Set all property path values\n                  paths.forEach((property) => {\n                    const [value] = resolveParticipantPaths(\n                      ev.participant as ExtendedDailyParticipant,\n                      [property]\n                    );\n                    set(\n                      participantPropertyState({\n                        id: ev.participant.session_id,\n                        property,\n                      }),\n                      (prev) => (customDeepEqual(prev, value) ? prev : value)\n                    );\n                  });\n                  break;\n                }\n                case 'participant-left': {\n                  // Remove from list of ids\n                  set(participantIdsState, (prevIds) =>\n                    prevIds.includes(ev.participant.session_id)\n                      ? [\n                          ...prevIds.filter(\n                            (id) => id !== ev.participant.session_id\n                          ),\n                        ]\n                      : prevIds\n                  );\n                  // Remove entire object\n                  reset(participantState(ev.participant.session_id));\n\n                  const oldPaths = get(\n                    participantPropertyPathsState(ev.participant.session_id)\n                  );\n                  // Remove property path values\n                  oldPaths.forEach((property) => {\n                    reset(\n                      participantPropertyState({\n                        id: ev.participant.session_id,\n                        property,\n                      })\n                    );\n                  });\n                  // Remove all property paths\n                  reset(\n                    participantPropertyPathsState(ev.participant.session_id)\n                  );\n                  break;\n                }\n                /**\n                 * Reset stored participants, when meeting has ended.\n                 */\n                case 'call-instance-destroyed':\n                case 'left-meeting': {\n                  reset(localIdState);\n                  const ids = get(participantIdsState);\n                  if (Array.isArray(ids))\n                    ids.forEach((id) => reset(participantState(id)));\n                  reset(participantIdsState);\n                  break;\n                }\n              }\n            });\n          });\n        },\n      []\n    )\n  );\n\n  useThrottledDailyEvent(\n    [\n      'waiting-participant-added',\n      'waiting-participant-updated',\n      'waiting-participant-removed',\n    ],\n    useRecoilCallback(\n      ({ transact_UNSTABLE }) =>\n        (evts) => {\n          transact_UNSTABLE(({ reset, set }) => {\n            evts.forEach((ev) => {\n              switch (ev.action) {\n                case 'waiting-participant-added':\n                  set(waitingParticipantsState, (wps) => {\n                    if (!wps.includes(ev.participant.id)) {\n                      return [...wps, ev.participant.id];\n                    }\n                    return wps;\n                  });\n                  set(\n                    waitingParticipantState(ev.participant.id),\n                    ev.participant\n                  );\n                  break;\n                case 'waiting-participant-updated':\n                  set(\n                    waitingParticipantState(ev.participant.id),\n                    ev.participant\n                  );\n                  break;\n                case 'waiting-participant-removed':\n                  set(waitingParticipantsState, (wps) =>\n                    wps.filter((wp) => wp !== ev.participant.id)\n                  );\n                  reset(waitingParticipantState(ev.participant.id));\n                  break;\n              }\n            });\n          });\n        },\n      []\n    )\n  );\n\n  return <>{children}</>;\n};\n","import { useDebugValue } from 'react';\nimport { useRecoilValue } from 'recoil';\n\nimport { localIdState } from '../DailyParticipants';\n\n/**\n * Returns the local participant's session_id or empty string '',\n * if the local participant doesn't exist.\n */\nexport const useLocalSessionId = () => {\n  const localId = useRecoilValue(localIdState);\n  useDebugValue(localId);\n  return localId;\n};\n","import { useDebugValue, useEffect, useState } from 'react';\nimport { useRecoilValue } from 'recoil';\n\nimport { activeIdState } from '../DailyParticipants';\nimport { useLocalSessionId } from './useLocalSessionId';\n\ninterface UseActiveSpeakerIdArgs {\n  /**\n   * Anytime the active-speaker-change event emits a new id, this callback can be used\n   * to determine if the new speaker id should be ignored or not.\n   * Return false from the callback to ignore the new speaker id in this hook's instance.\n   */\n  filter?(id: string | null): boolean;\n  /**\n   * If set to true, useActiveParticipant will never return the local participant.\n   */\n  ignoreLocal?: boolean;\n}\n\nconst noopFilter = () => true;\n\n/**\n * Returns the most recent speaker id mentioned in an [active-speaker-change](https://docs.daily.co/reference/daily-js/events/meeting-events#active-speaker-change) event.\n */\nexport const useActiveSpeakerId = ({\n  filter = noopFilter,\n  ignoreLocal = false,\n}: UseActiveSpeakerIdArgs = {}) => {\n  const localSessionId = useLocalSessionId();\n  const recentActiveId = useRecoilValue(activeIdState);\n  const isIgnoredLocalId = ignoreLocal && recentActiveId === localSessionId;\n  const isFilteredOut = !filter?.(recentActiveId);\n  const isRecentIdRelevant = !isIgnoredLocalId && !isFilteredOut;\n  const [activeId, setActiveId] = useState<string | null>(\n    isRecentIdRelevant ? recentActiveId : null\n  );\n\n  useEffect(() => {\n    if (isIgnoredLocalId || isFilteredOut) return;\n    setActiveId(recentActiveId);\n  }, [isFilteredOut, isIgnoredLocalId, recentActiveId]);\n\n  useDebugValue(activeId);\n\n  return activeId;\n};\n","import { DailyTrackState } from '@daily-co/daily-js';\n\nexport const isTrackOff = (trackState: DailyTrackState['state']) =>\n  ['blocked', 'off'].includes(trackState);\n","import { DailyEventObject } from '@daily-co/daily-js';\nimport { useCallback, useDebugValue, useEffect, useState } from 'react';\nimport { useRecoilCallback, useRecoilValue } from 'recoil';\n\nimport {\n  ExtendedDailyParticipant,\n  participantIdsState,\n  participantState,\n} from '../DailyParticipants';\nimport { RECOIL_PREFIX } from '../lib/constants';\nimport { customDeepEqual } from '../lib/customDeepEqual';\nimport { equalSelectorFamily } from '../lib/recoil-custom';\nimport { isTrackOff } from '../utils/isTrackOff';\nimport {\n  participantPropertiesState,\n  participantPropertyState,\n} from './useParticipantProperty';\nimport { useThrottledDailyEvent } from './useThrottledDailyEvent';\n\ntype FilterParticipantsFunction = (\n  p: ExtendedDailyParticipant,\n  index: number,\n  arr: ExtendedDailyParticipant[]\n) => boolean;\ntype SerializableFilterParticipants =\n  | 'local'\n  | 'remote'\n  | 'owner'\n  | 'record'\n  | 'screen';\ntype FilterParticipants =\n  | SerializableFilterParticipants\n  | FilterParticipantsFunction;\n\ntype SortParticipantsFunction = (\n  a: ExtendedDailyParticipant,\n  b: ExtendedDailyParticipant\n) => 1 | -1 | 0;\ntype SerializableSortParticipants =\n  | 'joined_at'\n  | 'session_id'\n  | 'user_id'\n  | 'user_name';\ntype SortParticipants = SerializableSortParticipants | SortParticipantsFunction;\n\n/**\n * Short-cut state selector for useParticipantIds({ filter: 'local' })\n */\nexport const participantIdsFilteredAndSortedState = equalSelectorFamily<\n  string[],\n  {\n    filter: SerializableFilterParticipants | null;\n    sort: SerializableSortParticipants | null;\n  }\n>({\n  key: RECOIL_PREFIX + 'participant-ids-filtered-sorted',\n  equals: customDeepEqual,\n  get:\n    ({ filter, sort }) =>\n    ({ get }) => {\n      const ids = get(participantIdsState);\n      return ids\n        .filter((id) => {\n          switch (filter) {\n            /**\n             * Simple boolean fields first.\n             */\n            case 'local':\n            case 'owner':\n            case 'record': {\n              return get(participantPropertyState({ id, property: filter }));\n            }\n            case 'remote': {\n              return !get(participantPropertyState({ id, property: 'local' }));\n            }\n            case 'screen': {\n              const [screenAudioState, screenVideoState] = get(\n                participantPropertiesState({\n                  id,\n                  properties: [\n                    'tracks.screenAudio.state',\n                    'tracks.screenVideo.state',\n                  ],\n                })\n              );\n              return (\n                !isTrackOff(screenAudioState) || !isTrackOff(screenVideoState)\n              );\n            }\n            default:\n              return true;\n          }\n        })\n        .sort((idA, idB) => {\n          switch (sort) {\n            case 'joined_at':\n            case 'session_id':\n            case 'user_id':\n            case 'user_name': {\n              const [aSort] = get(\n                participantPropertiesState({ id: idA, properties: [sort] })\n              );\n              const [bSort] = get(\n                participantPropertiesState({ id: idB, properties: [sort] })\n              );\n              if (aSort !== undefined || bSort !== undefined) {\n                if (aSort === undefined) return -1;\n                if (bSort === undefined) return 1;\n                if (aSort > bSort) return 1;\n                if (aSort < bSort) return -1;\n              }\n              return 0;\n            }\n            default:\n              return 0;\n          }\n        });\n    },\n});\n\ninterface UseParticipantIdsArgs {\n  filter?: FilterParticipants;\n  onActiveSpeakerChange?(ev: DailyEventObject<'active-speaker-change'>): void;\n  onParticipantJoined?(ev: DailyEventObject<'participant-joined'>): void;\n  onParticipantLeft?(ev: DailyEventObject<'participant-left'>): void;\n  onParticipantUpdated?(ev: DailyEventObject<'participant-updated'>): void;\n  sort?: SortParticipants;\n}\n\n/**\n * Returns a list of participant ids (= session_id).\n * The list can optionally be filtered and sorted, using the filter and sort options.\n */\nexport const useParticipantIds = ({\n  filter,\n  onActiveSpeakerChange,\n  onParticipantJoined,\n  onParticipantLeft,\n  onParticipantUpdated,\n  sort,\n}: UseParticipantIdsArgs = {}) => {\n  /**\n   * For instances of useParticipantIds with string-based filter and sort,\n   * we can immediately return the correct ids from Recoil's state.\n   */\n  const preFilteredSortedIds = useRecoilValue(\n    participantIdsFilteredAndSortedState({\n      filter: typeof filter === 'string' ? filter : null,\n      sort: typeof sort === 'string' ? sort : null,\n    })\n  );\n\n  const getCustomFilteredIds = useRecoilCallback(\n    ({ snapshot }) =>\n      () => {\n        if (\n          // Ignore if both filter and sort are not functions.\n          typeof filter !== 'function' &&\n          typeof sort !== 'function'\n        )\n          return [];\n\n        const participants: ExtendedDailyParticipant[] =\n          preFilteredSortedIds.map(\n            (id) =>\n              snapshot.getLoadable(participantState(id))\n                .contents as ExtendedDailyParticipant\n          );\n\n        return (\n          participants\n            // Make sure we don't accidentally try to filter/sort `null` participants\n            // This can happen when a participant's id is already present in store\n            // but the participant object is not stored, yet.\n            .filter(Boolean)\n            // Run custom filter, if it's a function. Otherwise don't filter any participants.\n            .filter(typeof filter === 'function' ? filter : () => true)\n            // Run custom sort, if it's a function. Otherwise don't sort.\n            .sort(typeof sort === 'function' ? sort : () => 0)\n            // Map back to session_id.\n            .map((p) => p.session_id)\n            // Filter any potential null/undefined ids.\n            // This shouldn't really happen, but better safe than sorry.\n            .filter(Boolean)\n        );\n      },\n    [filter, preFilteredSortedIds, sort]\n  );\n\n  const [customIds, setCustomIds] = useState<string[]>([]);\n\n  const maybeUpdateCustomIds = useCallback(() => {\n    const newIds = getCustomFilteredIds();\n    if (customDeepEqual(newIds, customIds)) return;\n    setCustomIds(newIds);\n  }, [customIds, getCustomFilteredIds]);\n\n  useEffect(() => {\n    maybeUpdateCustomIds();\n  }, [maybeUpdateCustomIds]);\n\n  useThrottledDailyEvent(\n    [\n      'participant-joined',\n      'participant-updated',\n      'active-speaker-change',\n      'participant-left',\n    ],\n    useCallback(\n      (evts) => {\n        if (!evts.length) return;\n        evts.forEach((ev) => {\n          switch (ev.action) {\n            case 'participant-joined':\n              onParticipantJoined?.(ev);\n              break;\n            case 'participant-updated':\n              onParticipantUpdated?.(ev);\n              break;\n            case 'active-speaker-change':\n              onActiveSpeakerChange?.(ev);\n              break;\n            case 'participant-left':\n              onParticipantLeft?.(ev);\n              break;\n          }\n        });\n        maybeUpdateCustomIds();\n      },\n      [\n        maybeUpdateCustomIds,\n        onActiveSpeakerChange,\n        onParticipantJoined,\n        onParticipantLeft,\n        onParticipantUpdated,\n      ]\n    )\n  );\n\n  const result =\n    typeof filter === 'function' || typeof sort === 'function'\n      ? customIds\n      : preFilteredSortedIds;\n\n  useDebugValue(result);\n\n  return result;\n};\n","import {\n  DailyCall,\n  DailyEventObjectNonFatalError,\n  DailyTrackState,\n} from '@daily-co/daily-js';\nimport { useCallback, useDebugValue } from 'react';\nimport { useRecoilValue } from 'recoil';\n\nimport { RECOIL_PREFIX } from '../lib/constants';\nimport { customDeepEqual } from '../lib/customDeepEqual';\nimport { equalSelector } from '../lib/recoil-custom';\nimport { Reconstruct } from '../types/Reconstruct';\nimport { useDaily } from './useDaily';\nimport { useDailyEvent } from './useDailyEvent';\nimport { participantIdsFilteredAndSortedState } from './useParticipantIds';\nimport { participantPropertyState } from './useParticipantProperty';\n\nexport interface ScreenShare {\n  local: boolean;\n  screenAudio: DailyTrackState;\n  screenVideo: DailyTrackState;\n  screenId: string;\n  session_id: string;\n}\n\nconst screenSharesState = equalSelector({\n  key: RECOIL_PREFIX + 'screen-shares',\n  equals: customDeepEqual,\n  get: ({ get }) => {\n    const screenIds = get(\n      participantIdsFilteredAndSortedState({ filter: 'screen', sort: null })\n    );\n    return screenIds.map<ScreenShare>((id) => {\n      return {\n        local: get(participantPropertyState({ id, property: 'local' })),\n        screenAudio: get(\n          participantPropertyState({ id, property: 'tracks.screenAudio' })\n        ),\n        screenVideo: get(\n          participantPropertyState({ id, property: 'tracks.screenVideo' })\n        ),\n        screenId: `${id}-screen`,\n        session_id: id,\n      };\n    });\n  },\n});\n\ntype DailyEventObjectScreenShareError = Reconstruct<\n  DailyEventObjectNonFatalError,\n  'type',\n  'screen-share-error'\n>;\n\ninterface UseScreenShareArgs {\n  onError?(ev: DailyEventObjectScreenShareError): void;\n  onLocalScreenShareStarted?(): void;\n  onLocalScreenShareStopped?(): void;\n}\n\n/**\n * Allows access to information about shared screens, and methods to start or stop a local screen share.\n */\nexport const useScreenShare = ({\n  onError,\n  onLocalScreenShareStarted,\n  onLocalScreenShareStopped,\n}: UseScreenShareArgs = {}) => {\n  const daily = useDaily();\n\n  const startScreenShare = useCallback(\n    (...args: Parameters<DailyCall['startScreenShare']>) => {\n      daily?.startScreenShare(...args);\n    },\n    [daily]\n  );\n\n  const stopScreenShare = useCallback(\n    (...args: Parameters<DailyCall['stopScreenShare']>) => {\n      daily?.stopScreenShare(...args);\n    },\n    [daily]\n  );\n\n  useDailyEvent(\n    'local-screen-share-started',\n    useCallback(\n      () => onLocalScreenShareStarted?.(),\n      [onLocalScreenShareStarted]\n    )\n  );\n  useDailyEvent(\n    'local-screen-share-stopped',\n    useCallback(\n      () => onLocalScreenShareStopped?.(),\n      [onLocalScreenShareStopped]\n    )\n  );\n  useDailyEvent(\n    'nonfatal-error',\n    useCallback(\n      (ev) => {\n        if (ev.type !== 'screen-share-error') return;\n        onError?.(ev as DailyEventObjectScreenShareError);\n      },\n      [onError]\n    )\n  );\n\n  const screens = useRecoilValue(screenSharesState);\n\n  const result = {\n    isSharingScreen: screens.some((s) => s.local),\n    screens,\n    startScreenShare,\n    stopScreenShare,\n  };\n\n  useDebugValue(result);\n\n  return result;\n};\n","import { DailyParticipantTracks, DailyTrackState } from '@daily-co/daily-js';\nimport { useDebugValue } from 'react';\n\nimport { isTrackOff } from '../utils/isTrackOff';\nimport { useParticipantProperty } from './useParticipantProperty';\n\ntype MediaType = keyof DailyParticipantTracks;\n\nexport interface MediaTrackState extends DailyTrackState {\n  isOff: boolean;\n}\n\n/**\n * Returns a participant's track and state, based on the given MediaType.\n *\n * Equivalent to daily.participants()[participantId].tracks[type].\n *\n * @param participantId The participant's session_id.\n * @param type The track type. Default: \"video\"\n */\nexport const useMediaTrack = (\n  participantId: string,\n  type: MediaType = 'video'\n): MediaTrackState => {\n  const trackState = useParticipantProperty(participantId, `tracks.${type}`);\n\n  const result: MediaTrackState = trackState\n    ? {\n        ...trackState,\n        isOff: isTrackOff(trackState.state),\n      }\n    : {\n        isOff: true,\n        persistentTrack: undefined,\n        state: 'off',\n        subscribed: false,\n      };\n\n  useDebugValue(result);\n\n  return result;\n};\n","/**\n * Original source: https://github.com/jaredLunde/react-hook/blob/master/packages/merged-ref/src/index.tsx\n * Original author: Jared Lunde (https://github.com/jaredLunde)\n * Originally published under the MIT license: https://github.com/jaredLunde/react-hook/blob/master/LICENSE\n */\n\nimport React, { useCallback } from 'react';\n\nfunction useMergedRef<T>(...refs: React.Ref<T>[]): React.RefCallback<T> {\n  return useCallback(\n    (element: T) => {\n      for (let i = 0; i < refs.length; i++) {\n        const ref = refs[i];\n        if (typeof ref === 'function') ref(element);\n        else if (ref && typeof ref === 'object')\n          (ref as React.MutableRefObject<T>).current = element;\n      }\n    },\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    refs\n  );\n}\n\nexport default useMergedRef;\n","import React, { forwardRef, memo, useEffect, useRef } from 'react';\n\nimport { useMediaTrack } from '../hooks/useMediaTrack';\nimport useMergedRef from '../hooks/useMergedRef';\n\nexport interface DailyAudioPlayException {\n  name?: string;\n  message?: string;\n  sessionId: string;\n  target: HTMLAudioElement;\n  type: string;\n}\n\ninterface Props extends React.AudioHTMLAttributes<HTMLAudioElement> {\n  /**\n   * Callback to handle failed attempt to play audio.\n   */\n  onPlayFailed?(e: DailyAudioPlayException): void;\n  sessionId: string;\n  type?: 'audio' | 'screenAudio' | 'rmpAudio';\n}\n\nexport const DailyAudioTrack = memo(\n  forwardRef<HTMLAudioElement, Props>(\n    ({ onPlayFailed, sessionId, type = 'audio', ...props }, ref) => {\n      const audioEl = useRef<HTMLAudioElement>(null);\n      const audio = useMediaTrack(sessionId, type);\n      const audioRef = useMergedRef<HTMLAudioElement>(audioEl, ref);\n      const subscribedState = audio?.subscribed;\n\n      /**\n       * Setup audio tag.\n       */\n      useEffect(() => {\n        const audioTag = audioEl.current;\n        if (!audioTag || !audio?.persistentTrack) return;\n        let playTimeout: ReturnType<typeof setTimeout>;\n        const handleCanPlay = () => {\n          audioTag.play().catch((e) => {\n            onPlayFailed?.({\n              sessionId,\n              target: audioTag,\n              type,\n              message: e.message,\n              name: e.name,\n            });\n          });\n        };\n        const handlePlay = () => {\n          clearTimeout(playTimeout);\n        };\n        audioTag.addEventListener('canplay', handleCanPlay);\n        audioTag.addEventListener('play', handlePlay);\n        audioTag.srcObject = new MediaStream([audio?.persistentTrack]);\n\n        return () => {\n          audioTag?.removeEventListener('canplay', handleCanPlay);\n          audioTag?.removeEventListener('play', handlePlay);\n        };\n      }, [audio?.persistentTrack, onPlayFailed, sessionId, type]);\n\n      return (\n        <audio\n          autoPlay\n          playsInline\n          ref={audioRef}\n          {...props}\n          data-session-id={sessionId}\n          data-audio-type={type}\n          data-subscribed={subscribedState}\n        />\n      );\n    }\n  )\n);\nDailyAudioTrack.displayName = 'DailyAudioTrack';\n","import React, {\n  forwardRef,\n  memo,\n  useCallback,\n  useImperativeHandle,\n  useRef,\n  useState,\n} from 'react';\nimport { useRecoilCallback } from 'recoil';\n\nimport { ExtendedDailyParticipant } from '../DailyParticipants';\nimport { useActiveSpeakerId } from '../hooks/useActiveSpeakerId';\nimport { useDaily } from '../hooks/useDaily';\nimport { useLocalSessionId } from '../hooks/useLocalSessionId';\nimport { useParticipantIds } from '../hooks/useParticipantIds';\nimport { participantPropertyState } from '../hooks/useParticipantProperty';\nimport { useScreenShare } from '../hooks/useScreenShare';\nimport { useThrottledDailyEvent } from '../hooks/useThrottledDailyEvent';\nimport { isTrackOff } from '../utils/isTrackOff';\nimport { DailyAudioPlayException, DailyAudioTrack } from './DailyAudioTrack';\n\ninterface Props {\n  /**\n   * When enabled and the call is configured for manual track subscriptions,\n   * DailyAudio will automatically subscribe to the active speaker's audio track.\n   */\n  autoSubscribeActiveSpeaker?: boolean;\n  /**\n   * Maximum amount of parallel speakers. Default: 5.\n   */\n  maxSpeakers?: number;\n  /**\n   * Callback to handle failed attempt to play audio.\n   */\n  onPlayFailed?(e: DailyAudioPlayException): void;\n  /**\n   * When enabled, plays audio from a local screenAudio track.\n   */\n  playLocalScreenAudio?: boolean;\n}\n\nexport interface DailyAudioHandle {\n  /**\n   * Returns all rendered audio elements.\n   */\n  getAllAudio(): HTMLAudioElement[];\n  /**\n   * Returns the audio element assigned to the current active speaker.\n   */\n  getActiveSpeakerAudio(): HTMLAudioElement | null;\n  /**\n   * Returns all rendered audio elements for rmpAudio tracks.\n   */\n  getRmpAudio(): HTMLAudioElement[];\n  /**\n   * Returns all rendered audio elements for screenAudio tracks.\n   */\n  getScreenAudio(): HTMLAudioElement[];\n  /**\n   * Returns the audio track for the given sessionId.\n   */\n  getAudioBySessionId(sessionId: string): HTMLAudioElement | null;\n  /**\n   * Returns the rmpAudio track for the given sessionId.\n   */\n  getRmpAudioBySessionId(sessionId: string): HTMLAudioElement | null;\n  /**\n   * Returns the screenAudio track for the given sessionId.\n   */\n  getScreenAudioBySessionId(sessionId: string): HTMLAudioElement | null;\n}\n\nexport const DailyAudio = memo(\n  forwardRef<DailyAudioHandle, Props>(\n    (\n      {\n        autoSubscribeActiveSpeaker = false,\n        maxSpeakers = 5,\n        onPlayFailed,\n        playLocalScreenAudio = false,\n      },\n      ref\n    ) => {\n      const daily = useDaily();\n      const [speakers, setSpeakers] = useState<string[]>(\n        new Array(maxSpeakers).fill('')\n      );\n      const { screens } = useScreenShare();\n      const localSessionId = useLocalSessionId();\n      const activeSpeakerId = useActiveSpeakerId({\n        ignoreLocal: true,\n      });\n\n      const containerRef = useRef<HTMLDivElement>(null);\n      useImperativeHandle(\n        ref,\n        () => ({\n          getActiveSpeakerAudio: () => {\n            return (\n              containerRef.current?.querySelector(\n                `audio[data-session-id=\"${activeSpeakerId}\"][data-audio-type=\"audio\"]`\n              ) ?? null\n            );\n          },\n          getAllAudio: () => {\n            return Array.from(\n              containerRef.current?.querySelectorAll('audio') ?? []\n            );\n          },\n          getAudioBySessionId: (id) => {\n            return (\n              containerRef.current?.querySelector(\n                `audio[data-session-id=\"${id}\"][data-audio-type=\"audio\"]`\n              ) ?? null\n            );\n          },\n          getRmpAudio: () => {\n            return Array.from(\n              containerRef.current?.querySelectorAll(\n                'audio[data-audio-type=\"rmpAudio\"]'\n              ) ?? []\n            );\n          },\n          getScreenAudio: () => {\n            return Array.from(\n              containerRef.current?.querySelectorAll(\n                'audio[data-audio-type=\"screenAudio\"]'\n              ) ?? []\n            );\n          },\n          getRmpAudioBySessionId: (id) => {\n            return (\n              containerRef.current?.querySelector(\n                `audio[data-session-id=\"${id}\"][data-audio-type=\"rmpAudio\"]`\n              ) ?? null\n            );\n          },\n          getScreenAudioBySessionId: (id) => {\n            return (\n              containerRef.current?.querySelector(\n                `audio[data-session-id=\"${id}\"][data-audio-type=\"screenAudio\"]`\n              ) ?? null\n            );\n          },\n        }),\n        [activeSpeakerId]\n      );\n\n      const assignSpeaker = useRecoilCallback(\n        ({ snapshot }) =>\n          async (sessionId: string) => {\n            /**\n             * Only consider remote participants with subscribed or staged audio.\n             */\n            const subscribedParticipants = Object.values(\n              daily?.participants() ?? {}\n            ).filter((p) => !p.local && Boolean(p.tracks.audio.subscribed));\n\n            const isSubscribed = (id: string) =>\n              subscribedParticipants.some((p) => p.session_id === id);\n\n            if (!isSubscribed(sessionId)) {\n              if (\n                daily &&\n                !daily.isDestroyed() &&\n                autoSubscribeActiveSpeaker &&\n                !daily.subscribeToTracksAutomatically()\n              ) {\n                daily.updateParticipant(sessionId, {\n                  setSubscribedTracks: {\n                    audio: true,\n                  },\n                });\n              } else {\n                return;\n              }\n            }\n\n            setSpeakers((prevSpeakers) => {\n              // New speaker is already present\n              if (prevSpeakers.includes(sessionId)) return prevSpeakers;\n\n              // Try to find a free slot: either unassigned or unsubscribed\n              const freeSlotCheck = (id: string) => !id || !isSubscribed(id);\n              if (prevSpeakers.some(freeSlotCheck)) {\n                const idx = prevSpeakers.findIndex(freeSlotCheck);\n                prevSpeakers[idx] = sessionId;\n                return [...prevSpeakers];\n              }\n\n              // From here on we can assume that all assigned audio tracks are subscribed.\n\n              // Try to find muted recent speaker\n              const mutedIdx = prevSpeakers.findIndex((id) =>\n                subscribedParticipants.some(\n                  (p) => p.session_id === id && isTrackOff(p.tracks.audio.state)\n                )\n              );\n              if (mutedIdx >= 0) {\n                prevSpeakers[mutedIdx] = sessionId;\n                return [...prevSpeakers];\n              }\n\n              // Find least recent non-active speaker and replace with new speaker\n              const speakerObjects = subscribedParticipants\n                .filter(\n                  (p) =>\n                    // Only consider participants currently assigned to speaker slots\n                    prevSpeakers.includes(p.session_id) &&\n                    // Don't replace current active participant, to avoid audio drop-outs\n                    p.session_id !== activeSpeakerId\n                )\n                .sort((a, b) => {\n                  const lastActiveA =\n                    snapshot.getLoadable(\n                      participantPropertyState({\n                        id: a.session_id,\n                        property: 'last_active',\n                      })\n                    ).contents ?? new Date('1970-01-01');\n                  const lastActiveB =\n                    snapshot.getLoadable(\n                      participantPropertyState({\n                        id: b.session_id,\n                        property: 'last_active',\n                      })\n                    ).contents ?? new Date('1970-01-01');\n                  if (lastActiveA > lastActiveB) return 1;\n                  if (lastActiveA < lastActiveB) return -1;\n                  return 0;\n                });\n\n              // No previous speaker in call anymore. Assign first free slot.\n              if (!speakerObjects.length) {\n                // Don't replace the active speaker. Instead find first non-active speaker slot.\n                const replaceIdx = prevSpeakers.findIndex(\n                  (id) => id !== activeSpeakerId\n                );\n                prevSpeakers[replaceIdx] = sessionId;\n                return [...prevSpeakers];\n              }\n\n              // Replace least recent speaker with new speaker\n              const replaceIdx = prevSpeakers.indexOf(\n                speakerObjects[0]?.session_id\n              );\n              prevSpeakers[replaceIdx] = sessionId;\n              return [...prevSpeakers];\n            });\n          },\n        [activeSpeakerId, autoSubscribeActiveSpeaker, daily]\n      );\n\n      /**\n       * Unassigns speaker from speaker slot, e.g. because participant left the call.\n       */\n      const removeSpeaker = useCallback((sessionId: string) => {\n        setSpeakers((prevSpeakers) => {\n          if (!prevSpeakers.includes(sessionId)) return prevSpeakers;\n          const newSpeakers = [...prevSpeakers];\n          const idx = newSpeakers.indexOf(sessionId);\n          newSpeakers[idx] = '';\n          return newSpeakers;\n        });\n      }, []);\n\n      useThrottledDailyEvent(\n        ['active-speaker-change', 'track-started', 'participant-left'],\n        useCallback(\n          (evts) => {\n            evts.forEach((ev) => {\n              switch (ev.action) {\n                case 'active-speaker-change':\n                  if (ev.activeSpeaker.peerId === localSessionId) return;\n                  assignSpeaker(ev.activeSpeaker.peerId);\n                  break;\n                case 'track-started':\n                  if (\n                    ev.track.kind === 'audio' &&\n                    ev.participant &&\n                    !ev.participant.local\n                  ) {\n                    assignSpeaker(ev.participant.session_id);\n                  }\n                  break;\n                case 'participant-left':\n                  removeSpeaker(ev.participant.session_id);\n                  break;\n              }\n            });\n          },\n          [assignSpeaker, localSessionId, removeSpeaker]\n        ),\n        200\n      );\n\n      const rmpAudioIds = useParticipantIds({\n        filter: useCallback(\n          (p: ExtendedDailyParticipant) => Boolean(p?.tracks?.rmpAudio),\n          []\n        ),\n      });\n\n      return (\n        <div ref={containerRef}>\n          {speakers.map((sessionId, idx) => (\n            <DailyAudioTrack\n              key={`speaker-slot-${idx}`}\n              onPlayFailed={onPlayFailed}\n              sessionId={sessionId}\n              type=\"audio\"\n            />\n          ))}\n          {screens\n            .filter((screen) => (playLocalScreenAudio ? true : !screen.local))\n            .map((screen) => (\n              <DailyAudioTrack\n                key={screen.screenId}\n                onPlayFailed={onPlayFailed}\n                sessionId={screen.session_id}\n                type=\"screenAudio\"\n              />\n            ))}\n          {rmpAudioIds.map((id) => (\n            <DailyAudioTrack\n              key={`${id}-rmp`}\n              onPlayFailed={onPlayFailed}\n              sessionId={id}\n              type=\"rmpAudio\"\n            />\n          ))}\n        </div>\n      );\n    }\n  )\n);\nDailyAudio.displayName = 'DailyAudio';\n","import React, { forwardRef, useEffect, useMemo, useRef } from 'react';\n\nimport { useLocalSessionId } from '../hooks/useLocalSessionId';\nimport { useMediaTrack } from '../hooks/useMediaTrack';\nimport useMergedRef from '../hooks/useMergedRef';\nimport { useParticipantProperty } from '../hooks/useParticipantProperty';\n\ninterface DailyVideoDimensions {\n  aspectRatio: number;\n  height: number;\n  width: number;\n}\n\ninterface Props extends React.VideoHTMLAttributes<HTMLVideoElement> {\n  /**\n   * For local user-facing camera streams, we'll automatically mirror the video.\n   */\n  automirror?: boolean;\n  /**\n   * Defines whether the video should be fully contained or cover the box. Default: 'contain'.\n   */\n  fit?: 'contain' | 'cover';\n  /**\n   * Forces the video to be mirrored, if set.\n   */\n  mirror?: boolean;\n  /**\n   * Optional styles to apply, when video is playable.\n   */\n  playableStyle?: React.CSSProperties;\n  /**\n   * Optional callback, which is triggered whenever the video's rendered width or height changes.\n   * Returns the video's native width, height and aspectRatio.\n   */\n  onResize?(dimensions: DailyVideoDimensions): void;\n  /**\n   * Identifies the participant for which a video stream should be rendered.\n   */\n  sessionId: string;\n  /**\n   * Defines the track type being used.\n   */\n  type: 'video' | 'screenVideo' | 'rmpVideo';\n}\n\nexport const DailyVideo = forwardRef<HTMLVideoElement, Props>(\n  function DailyVideo(\n    {\n      automirror,\n      fit = 'contain',\n      mirror,\n      onResize,\n      playableStyle = {},\n      sessionId,\n      style = {},\n      type = 'video',\n      ...props\n    },\n    ref\n  ) {\n    const localSessionId = useLocalSessionId();\n    const isLocal = localSessionId === sessionId;\n    const isScreen = type === 'screenVideo';\n    const isLocalCam = isLocal && !isScreen;\n\n    const videoEl = useRef<HTMLVideoElement>(null);\n    const videoRef = useMergedRef<HTMLVideoElement>(videoEl, ref);\n\n    const videoState = useMediaTrack(sessionId, type);\n    const videoTrack = videoState.persistentTrack;\n    /**\n     * Considered as playable video:\n     * - local cam feed\n     * - any screen share\n     * - remote cam feed that is subscribed and reported as playable\n     */\n    const isPlayable = isLocalCam || isScreen || !videoState.isOff;\n    const trackState = useParticipantProperty(sessionId, `tracks.${type}`);\n    const subscribedState = trackState?.subscribed;\n\n    /**\n     * Determine if video needs to be mirrored.\n     */\n    const isMirrored = useMemo(() => {\n      if (typeof mirror === 'boolean') return mirror;\n      if (!automirror) return false;\n      if (!videoTrack) return isLocalCam;\n\n      const videoTrackSettings = videoTrack.getSettings();\n      const isUsersFrontCamera =\n        'facingMode' in videoTrackSettings\n          ? isLocalCam && videoTrackSettings.facingMode === 'user'\n          : isLocalCam;\n      // only apply mirror effect to user facing camera\n      return isUsersFrontCamera;\n    }, [automirror, isLocalCam, mirror, videoTrack]);\n\n    /**\n     * Handle canplay & picture-in-picture events.\n     */\n    useEffect(function setupVideoEvents() {\n      const video = videoEl.current;\n      if (!video) return;\n\n      const playVideo = () => {\n        const promise = video.play();\n        if (promise !== undefined) {\n          promise\n            .then(() => {\n              // All good, playback started.\n              video.controls = false;\n            })\n            .catch((error) => {\n              // Auto-play was prevented. Show video controls, so user can play video manually.\n              video.controls = true;\n              console.warn('Failed to play video', error);\n            });\n        }\n      };\n\n      const handleCanPlay = () => {\n        if (!video.paused) return;\n        playVideo();\n      };\n      const handleEnterPIP = () => {\n        video.style.transform = 'scale(1)';\n      };\n      const handleLeavePIP = () => {\n        video.style.transform = '';\n        setTimeout(() => {\n          if (video.paused) playVideo();\n        }, 100);\n      };\n      const handleVisibilityChange = () => {\n        if (document.visibilityState === 'hidden') return;\n        if (!video.paused) return;\n        playVideo();\n      };\n      video.addEventListener('canplay', handleCanPlay);\n      video.addEventListener('enterpictureinpicture', handleEnterPIP);\n      video.addEventListener('leavepictureinpicture', handleLeavePIP);\n\n      // Videos can be paused if media was played in another app on iOS.\n      // Resuming here, when returning back to Daily call.\n      document.addEventListener('visibilitychange', handleVisibilityChange);\n      return () => {\n        video.removeEventListener('canplay', handleCanPlay);\n        video.removeEventListener('enterpictureinpicture', handleEnterPIP);\n        video.removeEventListener('leavepictureinpicture', handleLeavePIP);\n        document.removeEventListener(\n          'visibilitychange',\n          handleVisibilityChange\n        );\n      };\n    }, []);\n\n    /**\n     * Update srcObject.\n     */\n    useEffect(\n      function updateSrcObject() {\n        const video = videoEl.current;\n        if (!video || !videoTrack) return;\n        video.srcObject = new MediaStream([videoTrack]);\n        video.load();\n        return () => {\n          // clean up when unmounted\n          video.srcObject = null;\n          video.load();\n        };\n      },\n      [videoTrack, videoTrack?.id]\n    );\n\n    /**\n     * Add optional event listener for resize event so the parent component\n     * can know the video's native aspect ratio.\n     */\n    useEffect(\n      function reportVideoDimensions() {\n        const video = videoEl.current;\n        if (!onResize || !video) return;\n\n        let frame: ReturnType<typeof requestAnimationFrame>;\n        function handleResize() {\n          if (frame) cancelAnimationFrame(frame);\n          frame = requestAnimationFrame(() => {\n            const video = videoEl.current;\n            if (!video || document.hidden) return;\n            const videoWidth = video.videoWidth;\n            const videoHeight = video.videoHeight;\n            if (videoWidth && videoHeight) {\n              onResize?.({\n                aspectRatio: videoWidth / videoHeight,\n                height: videoHeight,\n                width: videoWidth,\n              });\n            }\n          });\n        }\n\n        handleResize();\n        video.addEventListener('loadedmetadata', handleResize);\n        video.addEventListener('resize', handleResize);\n\n        return () => {\n          if (frame) cancelAnimationFrame(frame);\n          video.removeEventListener('loadedmetadata', handleResize);\n          video.removeEventListener('resize', handleResize);\n        };\n      },\n      [onResize]\n    );\n\n    return (\n      <video\n        autoPlay\n        muted\n        playsInline\n        ref={videoRef}\n        data-local={isLocal}\n        // Only set data-mirrored and data-playable when true\n        data-mirrored={isMirrored || undefined}\n        data-playable={isPlayable || undefined}\n        data-session-id={sessionId}\n        data-subscribed={subscribedState}\n        data-video-type={type}\n        style={{\n          objectFit: fit,\n          transform: isMirrored ? 'scale(-1, 1)' : '',\n          ...style,\n          ...(isPlayable ? playableStyle : {}),\n        }}\n        {...props}\n      />\n    );\n  }\n);\nDailyVideo.displayName = 'DailyVideo';\n","import { createContext } from 'react';\n\ninterface DevicesContextValue {\n  refreshDevices(): Promise<void>;\n}\n\nexport const DailyDevicesContext = createContext<DevicesContextValue>({\n  refreshDevices: () => Promise.resolve(),\n});\n","import {\n  DailyCameraErrorObject,\n  DailyCameraErrorType,\n} from '@daily-co/daily-js';\nimport React, { useCallback } from 'react';\nimport { atom, useRecoilCallback } from 'recoil';\n\nimport { DailyDevicesContext } from './DailyDevicesContext';\nimport { useDaily } from './hooks/useDaily';\nimport { useDailyEvent } from './hooks/useDailyEvent';\nimport { RECOIL_PREFIX } from './lib/constants';\n\ntype GeneralState =\n  | 'idle'\n  | 'pending'\n  | 'not-supported'\n  | 'granted'\n  | 'blocked'\n  | 'in-use'\n  | 'not-found'\n  | 'constraints-invalid'\n  | 'constraints-none-specified'\n  | 'undefined-mediadevices'\n  | 'unknown';\n\ntype DeviceState = 'granted' | 'in-use';\nexport interface StatefulDevice {\n  device: MediaDeviceInfo;\n  selected: boolean;\n  state: DeviceState;\n}\n\nexport const generalCameraState = atom<GeneralState>({\n  key: RECOIL_PREFIX + 'general-camera-state',\n  default: 'idle',\n});\nexport const generalMicrophoneState = atom<GeneralState>({\n  key: RECOIL_PREFIX + 'general-microphone-state',\n  default: 'idle',\n});\nexport const cameraDevicesState = atom<StatefulDevice[]>({\n  key: RECOIL_PREFIX + 'camera-devices',\n  default: [],\n});\nexport const microphoneDevicesState = atom<StatefulDevice[]>({\n  key: RECOIL_PREFIX + 'microphone-devices',\n  default: [],\n});\nexport const speakerDevicesState = atom<StatefulDevice[]>({\n  key: RECOIL_PREFIX + 'speaker-devices',\n  default: [],\n});\nexport const lastCameraErrorState =\n  atom<DailyCameraErrorObject<DailyCameraErrorType> | null>({\n    key: RECOIL_PREFIX + 'last-camera-error',\n    default: null,\n  });\n\nexport const DailyDevices: React.FC<React.PropsWithChildren<unknown>> = ({\n  children,\n}) => {\n  const daily = useDaily();\n\n  /**\n   * Refreshes list of available devices using enumerateDevices.\n   * Previous device states are kept in place, otherwise states are initialized as 'granted'.\n   */\n  const refreshDevices = useRecoilCallback(\n    ({ transact_UNSTABLE }) =>\n      async () => {\n        /**\n         * Check for legacy browsers.\n         */\n        if (\n          typeof navigator?.mediaDevices?.getUserMedia === 'undefined' ||\n          typeof navigator?.mediaDevices?.enumerateDevices === 'undefined'\n        ) {\n          transact_UNSTABLE(({ set }) => {\n            set(generalCameraState, 'not-supported');\n            set(generalMicrophoneState, 'not-supported');\n          });\n          return;\n        }\n\n        if (!daily) return;\n\n        try {\n          const { devices } = await daily.enumerateDevices();\n          /**\n           * Filter out \"empty\" devices for when device access has not been granted (yet).\n           */\n          const cams = devices.filter(\n            (d) => d.kind === 'videoinput' && d.deviceId !== ''\n          );\n          const mics = devices.filter(\n            (d) => d.kind === 'audioinput' && d.deviceId !== ''\n          );\n          const speakers = devices.filter(\n            (d) => d.kind === 'audiooutput' && d.deviceId !== ''\n          );\n          const { camera, mic, speaker } = await daily.getInputDevices();\n\n          const mapDevice = (\n            device: {} | MediaDeviceInfo,\n            d: MediaDeviceInfo,\n            prevDevices: StatefulDevice[]\n          ) => ({\n            device: d,\n            selected: 'deviceId' in device && d.deviceId === device.deviceId,\n            state:\n              prevDevices.find((p) => p.device.deviceId === d.deviceId)\n                ?.state ?? 'granted',\n          });\n          const sortDeviceByLabel = (a: StatefulDevice, b: StatefulDevice) => {\n            if (a.device.deviceId === 'default') return -1;\n            if (b.device.deviceId === 'default') return 1;\n            if (a.device.label < b.device.label) return -1;\n            if (a.device.label > b.device.label) return 1;\n            return 0;\n          };\n\n          transact_UNSTABLE(({ set }) => {\n            set(cameraDevicesState, (prevCams) =>\n              cams\n                .filter(Boolean)\n                .map<StatefulDevice>((d) => mapDevice(camera, d, prevCams))\n                .sort(sortDeviceByLabel)\n            );\n            set(microphoneDevicesState, (prevMics) =>\n              mics\n                .filter(Boolean)\n                .map<StatefulDevice>((d) => mapDevice(mic, d, prevMics))\n                .sort(sortDeviceByLabel)\n            );\n            set(speakerDevicesState, (prevSpeakers) =>\n              speakers\n                .filter(Boolean)\n                .map<StatefulDevice>((d) => mapDevice(speaker, d, prevSpeakers))\n                .sort(sortDeviceByLabel)\n            );\n          });\n        } catch (e) {\n          transact_UNSTABLE(({ set }) => {\n            set(generalCameraState, 'not-supported');\n            set(generalMicrophoneState, 'not-supported');\n          });\n        }\n      },\n    [daily]\n  );\n\n  /**\n   * Updates general and specific device states, based on blocked status.\n   */\n  const updateDeviceStates = useRecoilCallback(\n    ({ set, snapshot, transact_UNSTABLE }) =>\n      async () => {\n        if (!daily) return;\n\n        const currentCamState = await snapshot.getPromise(generalCameraState);\n        const currentMicState = await snapshot.getPromise(\n          generalMicrophoneState\n        );\n\n        const participants = daily.participants();\n        // Guard against potentially uninitialized local participant\n        if (!participants.local) return;\n\n        const { tracks } = participants.local;\n\n        let camPermissionState: PermissionState = 'prompt';\n        let micPermissionState: PermissionState = 'prompt';\n        if (navigator.permissions) {\n          try {\n            const camPermission = await navigator.permissions.query({\n              // @ts-ignore\n              name: 'camera',\n            });\n            camPermissionState = camPermission.state;\n            const micPermission = await navigator.permissions.query({\n              // @ts-ignore\n              name: 'microphone',\n            });\n            micPermissionState = micPermission.state;\n          } catch {\n            // Permissions query not available\n          }\n        }\n\n        const awaitingCamAccess =\n          camPermissionState === 'prompt' &&\n          ['idle', 'pending'].includes(currentCamState) &&\n          tracks.video.state === 'interrupted' &&\n          !tracks.video.persistentTrack;\n        const initialCamOff =\n          ['idle', 'pending'].includes(currentCamState) &&\n          !tracks.video.persistentTrack &&\n          Boolean(tracks.video.off?.byUser);\n        const awaitingMicAccess =\n          micPermissionState === 'prompt' &&\n          ['idle', 'pending'].includes(currentMicState) &&\n          tracks.audio.state === 'interrupted' &&\n          !tracks.audio.persistentTrack;\n        const initialMicOff =\n          ['idle', 'pending'].includes(currentMicState) &&\n          !tracks.audio.persistentTrack &&\n          Boolean(tracks.audio.off?.byUser);\n\n        if (tracks.audio?.blocked?.byDeviceInUse) {\n          transact_UNSTABLE(({ set }) => {\n            set(generalMicrophoneState, 'in-use');\n            set(microphoneDevicesState, (mics) =>\n              mics.map<StatefulDevice>((m) =>\n                m.selected ? { ...m, state: 'in-use' } : m\n              )\n            );\n          });\n        } else if (tracks.audio?.blocked?.byDeviceMissing) {\n          set(generalMicrophoneState, 'not-found');\n        } else if (\n          tracks.audio?.blocked?.byPermissions ||\n          micPermissionState === 'denied'\n        ) {\n          set(generalMicrophoneState, 'blocked');\n        } else if (awaitingMicAccess) {\n          set(generalMicrophoneState, 'pending');\n        } else if (initialMicOff) {\n          set(generalMicrophoneState, 'idle');\n        } else {\n          transact_UNSTABLE(({ set }) => {\n            set(generalMicrophoneState, 'granted');\n            set(microphoneDevicesState, (mics) =>\n              mics.map<StatefulDevice>((m) =>\n                m.selected ? { ...m, state: 'granted' } : m\n              )\n            );\n          });\n        }\n\n        if (tracks.video?.blocked?.byDeviceInUse) {\n          transact_UNSTABLE(({ set }) => {\n            set(generalCameraState, 'in-use');\n            set(cameraDevicesState, (cams) =>\n              cams.map<StatefulDevice>((m) =>\n                m.selected ? { ...m, state: 'in-use' } : m\n              )\n            );\n          });\n        } else if (tracks.video?.blocked?.byDeviceMissing) {\n          set(generalCameraState, 'not-found');\n        } else if (\n          tracks.video?.blocked?.byPermissions ||\n          camPermissionState === 'denied'\n        ) {\n          set(generalCameraState, 'blocked');\n        } else if (awaitingCamAccess) {\n          set(generalCameraState, 'pending');\n        } else if (initialCamOff) {\n          set(generalCameraState, 'idle');\n        } else {\n          transact_UNSTABLE(({ set }) => {\n            set(generalCameraState, 'granted');\n            set(cameraDevicesState, (cams) =>\n              cams.map<StatefulDevice>((m) =>\n                m.selected ? { ...m, state: 'granted' } : m\n              )\n            );\n          });\n        }\n        refreshDevices();\n      },\n    [daily, refreshDevices]\n  );\n\n  useDailyEvent(\n    'participant-updated',\n    useCallback(\n      (ev) => {\n        if (!ev.participant.local) return;\n        updateDeviceStates();\n      },\n      [updateDeviceStates]\n    )\n  );\n\n  useDailyEvent('available-devices-updated', refreshDevices);\n  useDailyEvent('selected-devices-updated', refreshDevices);\n\n  useDailyEvent(\n    'camera-error',\n    useRecoilCallback(\n      ({ transact_UNSTABLE }) =>\n        (ev) => {\n          transact_UNSTABLE(({ set }) => {\n            set(lastCameraErrorState, ev.error);\n            switch (ev.error?.type) {\n              case 'cam-in-use':\n                set(generalCameraState, 'in-use');\n                break;\n              case 'mic-in-use':\n                set(generalMicrophoneState, 'in-use');\n                break;\n              case 'cam-mic-in-use':\n                set(generalCameraState, 'in-use');\n                set(generalMicrophoneState, 'in-use');\n                break;\n              case 'not-found':\n                if (ev.error?.missingMedia.includes('video'))\n                  set(generalCameraState, 'not-found');\n                if (ev.error?.missingMedia.includes('audio'))\n                  set(generalMicrophoneState, 'not-found');\n                break;\n              case 'permissions':\n                if (ev.error?.blockedMedia.includes('video'))\n                  set(generalCameraState, 'blocked');\n                if (ev.error?.blockedMedia.includes('audio'))\n                  set(generalMicrophoneState, 'blocked');\n                break;\n              case 'constraints':\n                if (ev.error?.reason === 'invalid') {\n                  set(generalCameraState, 'constraints-invalid');\n                  set(generalMicrophoneState, 'constraints-invalid');\n                } else if (ev.error?.reason === 'none-specified') {\n                  set(generalCameraState, 'constraints-none-specified');\n                  set(generalMicrophoneState, 'constraints-none-specified');\n                }\n                break;\n              case 'undefined-mediadevices':\n                set(generalCameraState, 'undefined-mediadevices');\n                set(generalMicrophoneState, 'undefined-mediadevices');\n                break;\n              case 'unknown':\n              default:\n                set(generalCameraState, 'unknown');\n                set(generalMicrophoneState, 'unknown');\n                break;\n            }\n          });\n        },\n      []\n    )\n  );\n\n  /**\n   * Update all device state, when camera is started.\n   */\n  useDailyEvent(\n    'started-camera',\n    useRecoilCallback(\n      ({ transact_UNSTABLE }) =>\n        () => {\n          transact_UNSTABLE(({ set }) => {\n            set(generalCameraState, 'granted');\n            set(generalMicrophoneState, 'granted');\n          });\n          updateDeviceStates();\n        },\n      [updateDeviceStates]\n    )\n  );\n\n  return (\n    <DailyDevicesContext.Provider value={{ refreshDevices }}>\n      {children}\n    </DailyDevicesContext.Provider>\n  );\n};\n","import { DailyStreamingLayoutConfig } from '@daily-co/daily-js';\nimport React from 'react';\nimport { atom, useRecoilCallback } from 'recoil';\n\nimport { useDailyEvent } from './hooks/useDailyEvent';\nimport { RECOIL_PREFIX } from './lib/constants';\n\ninterface LiveStreamingState {\n  errorMsg?: string;\n  isLiveStreaming: boolean;\n  layout?: DailyStreamingLayoutConfig;\n}\n\nexport const liveStreamingState = atom<LiveStreamingState>({\n  key: RECOIL_PREFIX + 'live-streaming',\n  default: {\n    errorMsg: undefined,\n    isLiveStreaming: false,\n    layout: undefined,\n  },\n});\n\nexport const DailyLiveStreaming: React.FC<React.PropsWithChildren<unknown>> = ({\n  children,\n}) => {\n  useDailyEvent(\n    'live-streaming-started',\n    useRecoilCallback(\n      ({ set }) =>\n        (ev) => {\n          set(liveStreamingState, {\n            isLiveStreaming: true,\n            layout: ev?.layout,\n          });\n        },\n      []\n    )\n  );\n\n  useDailyEvent(\n    'live-streaming-stopped',\n    useRecoilCallback(\n      ({ set }) =>\n        () => {\n          set(liveStreamingState, (prevState) => ({\n            ...prevState,\n            isLiveStreaming: false,\n            layout: undefined,\n          }));\n        },\n      []\n    )\n  );\n\n  useDailyEvent(\n    'live-streaming-error',\n    useRecoilCallback(\n      ({ set }) =>\n        (ev) => {\n          set(liveStreamingState, (prevState) => ({\n            ...prevState,\n            errorMsg: ev.errorMsg,\n          }));\n        },\n      []\n    )\n  );\n\n  useDailyEvent(\n    'left-meeting',\n    useRecoilCallback(\n      ({ reset }) =>\n        () => {\n          reset(liveStreamingState);\n        },\n      []\n    )\n  );\n\n  return <>{children}</>;\n};\n","import {\n  DailyEventObjectFatalError,\n  DailyEventObjectNonFatalError,\n  DailyMeetingSessionState,\n  DailyMeetingState,\n} from '@daily-co/daily-js';\nimport React from 'react';\nimport { atom, useRecoilCallback } from 'recoil';\n\nimport { useDaily } from './hooks/useDaily';\nimport { useDailyEvent } from './hooks/useDailyEvent';\nimport { RECOIL_PREFIX } from './lib/constants';\n\nexport const meetingStateState = atom<DailyMeetingState>({\n  key: RECOIL_PREFIX + 'meeting-state',\n  default: 'new',\n});\n\nexport const meetingErrorState = atom<DailyEventObjectFatalError | null>({\n  key: RECOIL_PREFIX + 'meeting-error',\n  default: null,\n});\n\nexport const nonFatalErrorState = atom<DailyEventObjectNonFatalError | null>({\n  key: RECOIL_PREFIX + 'non-fatal-error',\n  default: null,\n});\n\nexport const meetingSessionDataState = atom<DailyMeetingSessionState>({\n  key: 'meeting-session-data',\n  default: {\n    data: undefined,\n    topology: 'none',\n  },\n});\n\nexport const DailyMeeting: React.FC<React.PropsWithChildren<{}>> = ({\n  children,\n}) => {\n  const daily = useDaily();\n\n  /**\n   * Updates meeting state.\n   */\n  const updateMeetingState = useRecoilCallback(\n    ({ set }) =>\n      () => {\n        if (!daily) return;\n        const meetingState = daily.meetingState();\n        set(meetingStateState, meetingState);\n        return meetingState;\n      },\n    [daily]\n  );\n\n  useDailyEvent('loading', updateMeetingState);\n  useDailyEvent('loaded', updateMeetingState);\n  useDailyEvent('joining-meeting', updateMeetingState);\n  useDailyEvent('joined-meeting', updateMeetingState);\n  useDailyEvent('left-meeting', updateMeetingState);\n  useDailyEvent(\n    'error',\n    useRecoilCallback(\n      ({ set }) =>\n        (ev) => {\n          set(meetingErrorState, ev);\n          updateMeetingState();\n        },\n      [updateMeetingState]\n    )\n  );\n  useDailyEvent(\n    'nonfatal-error',\n    useRecoilCallback(\n      ({ set }) =>\n        (ev) => {\n          set(nonFatalErrorState, ev);\n        },\n      []\n    )\n  );\n\n  /**\n   * Updates meeting session state.\n   */\n  const initMeetingSessionState = useRecoilCallback(\n    ({ set }) =>\n      () => {\n        if (!daily) return;\n        set(meetingSessionDataState, daily.meetingSessionState());\n      },\n    [daily]\n  );\n\n  /**\n   * Initialize state when joined meeting or setting up the hook.\n   */\n  useDailyEvent('joined-meeting', initMeetingSessionState);\n\n  /**\n   * Update Recoil state whenever meeting session state is updated.\n   */\n  useDailyEvent(\n    'meeting-session-state-updated',\n    useRecoilCallback(\n      ({ set }) =>\n        (ev) => {\n          set(meetingSessionDataState, ev.meetingSessionState);\n        },\n      []\n    )\n  );\n\n  /**\n   * Reset Recoil state when meeting ends.\n   */\n  useDailyEvent(\n    'left-meeting',\n    useRecoilCallback(\n      ({ reset }) =>\n        () => {\n          reset(meetingSessionDataState);\n        },\n      []\n    )\n  );\n\n  /**\n   * Reset Recoil state when call instance is destroyed.\n   */\n  useDailyEvent(\n    'call-instance-destroyed',\n    useRecoilCallback(\n      ({ transact_UNSTABLE }) =>\n        () => {\n          transact_UNSTABLE(({ reset }) => {\n            reset(meetingStateState);\n            reset(meetingErrorState);\n            reset(nonFatalErrorState);\n            reset(meetingSessionDataState);\n          });\n        },\n      []\n    )\n  );\n\n  return <>{children}</>;\n};\n","import { DailyNetworkStats, DailyNetworkTopology } from '@daily-co/daily-js';\nimport React, { useEffect } from 'react';\nimport { atom, useRecoilCallback, useRecoilValue } from 'recoil';\n\nimport { useDaily } from './hooks/useDaily';\nimport { useDailyEvent } from './hooks/useDailyEvent';\nimport { RECOIL_PREFIX } from './lib/constants';\n\nexport const topologyState = atom<DailyNetworkTopology | 'none'>({\n  key: RECOIL_PREFIX + 'topology',\n  default: 'none',\n});\nexport const networkQualityState = atom<DailyNetworkStats['quality']>({\n  key: RECOIL_PREFIX + 'networkQuality',\n  default: 100,\n});\nexport const networkThresholdState = atom<DailyNetworkStats['threshold']>({\n  key: RECOIL_PREFIX + 'networkThreshold',\n  default: 'good',\n});\n\nexport const DailyNetwork: React.FC<React.PropsWithChildren<{}>> = ({\n  children,\n}) => {\n  const daily = useDaily();\n\n  const topology = useRecoilValue(topologyState);\n\n  const initTopology = useRecoilCallback(\n    ({ set }) =>\n      async () => {\n        if (!daily) return;\n        const topology = await daily.getNetworkTopology();\n        if (!topology || topology?.topology === 'none') return;\n        set(topologyState, topology.topology);\n      },\n    [daily]\n  );\n\n  useDailyEvent('joined-meeting', initTopology);\n  useDailyEvent(\n    'network-connection',\n    useRecoilCallback(\n      ({ set }) =>\n        (ev) => {\n          switch (ev.event) {\n            case 'connected':\n              if (ev.type === 'peer-to-peer') set(topologyState, 'peer');\n              if (ev.type === 'sfu') set(topologyState, 'sfu');\n              break;\n          }\n        },\n      []\n    )\n  );\n  useDailyEvent(\n    'network-quality-change',\n    useRecoilCallback(\n      ({ transact_UNSTABLE }) =>\n        (ev) => {\n          transact_UNSTABLE(({ set }) => {\n            set(networkQualityState, (prevQuality) =>\n              prevQuality !== ev.quality ? ev.quality : prevQuality\n            );\n            set(networkThresholdState, (prevThreshold) =>\n              prevThreshold !== ev.threshold ? ev.threshold : prevThreshold\n            );\n          });\n        },\n      []\n    )\n  );\n\n  useDailyEvent(\n    'left-meeting',\n    useRecoilCallback(\n      ({ transact_UNSTABLE }) =>\n        () => {\n          transact_UNSTABLE(({ reset }) => {\n            reset(topologyState);\n            reset(networkQualityState);\n            reset(networkThresholdState);\n          });\n        },\n      []\n    )\n  );\n\n  useEffect(() => {\n    if (!daily || topology !== 'none') return;\n    initTopology();\n  }, [daily, initTopology, topology]);\n\n  return <>{children}</>;\n};\n","import { DailyStreamingLayoutConfig } from '@daily-co/daily-js';\nimport React, { useEffect } from 'react';\nimport { atom, useRecoilCallback, useSetRecoilState } from 'recoil';\n\nimport { useDailyEvent } from './hooks/useDailyEvent';\nimport { useLocalSessionId } from './hooks/useLocalSessionId';\nimport { useParticipantIds } from './hooks/useParticipantIds';\nimport { RECOIL_PREFIX } from './lib/constants';\n\ninterface RecordingState {\n  /**\n   * Determines whether an error occurred during the last recording attempt.\n   */\n  error?: boolean;\n  /**\n   * Determines whether the local participant is being recorded, based on the recording settings.\n   */\n  isLocalParticipantRecorded: boolean;\n  /**\n   * Determines whether a recording is currently running or not.\n   */\n  isRecording: boolean;\n  /**\n   * Contains the last applied cloud recording layout config.\n   */\n  layout?: DailyStreamingLayoutConfig;\n  /**\n   * Determines whether the recording is running locally.\n   * See [enable_recording](https://docs.daily.co/reference/rest-api/rooms/config#enable_recording).\n   */\n  local?: boolean;\n  /**\n   * Contains the recording id.\n   */\n  recordingId?: string;\n  /**\n   * Contains the date when the 'recording-started' event was received.\n   * This doesn't necessarily match the date the recording was actually started.\n   */\n  recordingStartedDate?: Date;\n  /**\n   * Contains the session_id of the participant who started the recording.\n   */\n  startedBy?: string;\n  /**\n   * Contains the recording type.\n   * See [enable_recording](https://docs.daily.co/reference/rest-api/rooms/config#enable_recording).\n   */\n  type?: string;\n}\n\nexport const recordingState = atom<RecordingState>({\n  key: RECOIL_PREFIX + 'recording',\n  default: {\n    isLocalParticipantRecorded: false,\n    isRecording: false,\n  },\n});\n\nexport const DailyRecordings: React.FC<React.PropsWithChildren<unknown>> = ({\n  children,\n}) => {\n  const setState = useSetRecoilState(recordingState);\n\n  const localSessionId = useLocalSessionId();\n\n  const recordingParticipantIds = useParticipantIds({\n    filter: 'record',\n  });\n  /**\n   * Update recording state, whenever amount of recording participants changes.\n   */\n  useEffect(() => {\n    const hasRecordingParticipants = recordingParticipantIds.length > 0;\n    const isLocalParticipantRecording = recordingParticipantIds.includes(\n      localSessionId || 'local'\n    );\n    setState((s) => ({\n      ...s,\n      // In case type is local or not set, determine based on recording participants\n      isLocalParticipantRecorded:\n        s?.type === 'local' || !s?.type\n          ? hasRecordingParticipants\n          : s.isLocalParticipantRecorded,\n      isRecording:\n        s?.type === 'local' || !s?.type\n          ? hasRecordingParticipants\n          : s.isRecording,\n      local:\n        (s?.type === 'local' || !s?.type) && hasRecordingParticipants\n          ? isLocalParticipantRecording\n          : s?.local,\n      /**\n       * Set type in case recording participants are detected.\n       * We only set `record` on participants, when recording type is 'local'.\n       */\n      type: hasRecordingParticipants ? 'local' : s?.type,\n    }));\n  }, [localSessionId, recordingParticipantIds, setState]);\n\n  useDailyEvent(\n    'recording-started',\n    useRecoilCallback(\n      ({ set }) =>\n        (ev) => {\n          let isLocalParticipantRecorded = true;\n          switch (ev.type) {\n            case 'cloud-beta':\n            case 'cloud': {\n              if (\n                localSessionId &&\n                ev.layout?.preset === 'single-participant' &&\n                ev.layout.session_id !== localSessionId\n              ) {\n                isLocalParticipantRecorded = false;\n              }\n              break;\n            }\n          }\n          set(recordingState, {\n            error: false,\n            isLocalParticipantRecorded,\n            isRecording: true,\n            layout: ev?.layout,\n            local: ev?.local,\n            recordingId: ev?.recordingId,\n            recordingStartedDate: new Date(),\n            startedBy: ev?.startedBy,\n            type: ev?.type,\n          });\n        },\n      [localSessionId]\n    )\n  );\n  useDailyEvent(\n    'recording-stopped',\n    useRecoilCallback(\n      ({ set }) =>\n        () => {\n          set(recordingState, (prevState) => ({\n            ...prevState,\n            isLocalParticipantRecorded: false,\n            isRecording: false,\n          }));\n        },\n      []\n    )\n  );\n  useDailyEvent(\n    'recording-error',\n    useRecoilCallback(\n      ({ set }) =>\n        () => {\n          set(recordingState, (prevState) => ({\n            ...prevState,\n            error: true,\n            isLocalParticipantRecorded: false,\n            isRecording: false,\n          }));\n        },\n      []\n    )\n  );\n  useDailyEvent(\n    'left-meeting',\n    useRecoilCallback(\n      ({ reset }) =>\n        () => {\n          reset(recordingState);\n        },\n      []\n    )\n  );\n  return <>{children}</>;\n};\n","import { DailyMeetingState } from '@daily-co/daily-js';\nimport { useDebugValue } from 'react';\nimport { useRecoilValue } from 'recoil';\n\nimport { meetingStateState } from '../DailyMeeting';\n\n/**\n * Returns a meeting's current state.\n */\nexport const useMeetingState = (): DailyMeetingState | null => {\n  const meetingState = useRecoilValue(meetingStateState);\n  useDebugValue(meetingState);\n  return meetingState;\n};\n","import { DailyRoomInfo } from '@daily-co/daily-js';\nimport React from 'react';\nimport { atom, useRecoilCallback } from 'recoil';\n\nimport { useDaily } from './hooks/useDaily';\nimport { useDailyEvent } from './hooks/useDailyEvent';\nimport { useMeetingState } from './hooks/useMeetingState';\nimport { RECOIL_PREFIX } from './lib/constants';\n\nexport const roomState = atom<DailyRoomInfo | null>({\n  key: RECOIL_PREFIX + 'room',\n  default: null,\n});\n\nexport const DailyRoom: React.FC<React.PropsWithChildren<{}>> = ({\n  children,\n}) => {\n  const daily = useDaily();\n  const meetingState = useMeetingState();\n\n  const updateRoom = useRecoilCallback(\n    ({ set }) =>\n      async () => {\n        if (!daily || meetingState === 'left-meeting') return;\n        const room = await daily.room();\n        if (room && 'id' in room) {\n          set(roomState, room);\n        }\n        return room;\n      },\n    [daily, meetingState]\n  );\n\n  useDailyEvent('access-state-updated', updateRoom);\n\n  useDailyEvent(\n    'left-meeting',\n    useRecoilCallback(\n      ({ reset }) =>\n        () => {\n          reset(roomState);\n        },\n      []\n    )\n  );\n\n  return <>{children}</>;\n};\n","import {\n  DailyEventObjectAppMessage,\n  DailyTranscriptionDeepgramOptions,\n} from '@daily-co/daily-js';\nimport React from 'react';\nimport { atom, useRecoilCallback } from 'recoil';\n\nimport { useDailyEvent } from './hooks/useDailyEvent';\nimport { RECOIL_PREFIX } from './lib/constants';\n\nexport interface Transcription {\n  session_id: string;\n  user_id: string;\n  is_final: boolean;\n  text: string;\n  timestamp: string;\n}\n\ninterface TranscriptionState extends DailyTranscriptionDeepgramOptions {\n  /**\n   * Determines whether an error occurred during the last transcription attempt.\n   */\n  error?: boolean;\n  /**\n   * Determines whether a transcription is currently running or not.\n   */\n  isTranscribing: boolean;\n  /**\n   * Contains the date when the 'transcription-started' event was received.\n   * This doesn't necessarily match the date the transcription was actually started.\n   */\n  transcriptionStartDate?: Date;\n  /**\n   * Contains the session_id of the participant who started the transcription.\n   */\n  startedBy?: string;\n  /**\n   * Contains the session_id of the participant who updated the transcription.\n   */\n  updatedBy?: string;\n  /**\n   * Contains the transcriptions that we received.\n   */\n  transcriptions: Transcription[];\n}\n\nexport const transcriptionState = atom<TranscriptionState>({\n  key: RECOIL_PREFIX + 'transcription',\n  default: {\n    isTranscribing: false,\n    model: 'general',\n    language: 'en',\n    transcriptions: [],\n  },\n});\n\nexport const DailyTranscriptions: React.FC<React.PropsWithChildren<{}>> = ({\n  children,\n}) => {\n  useDailyEvent(\n    'transcription-started',\n    useRecoilCallback(\n      ({ set }) =>\n        (ev) => {\n          set(transcriptionState, {\n            error: false,\n            isTranscribing: true,\n            transcriptionStartDate: new Date(),\n            transcriptions: [],\n            ...ev,\n          });\n        },\n      []\n    )\n  );\n  useDailyEvent(\n    'transcription-stopped',\n    useRecoilCallback(\n      ({ set }) =>\n        (ev) => {\n          set(transcriptionState, (prevState) => ({\n            ...prevState,\n            updatedBy: ev?.updatedBy,\n            isTranscribing: false,\n          }));\n        },\n      []\n    )\n  );\n  useDailyEvent(\n    'transcription-error',\n    useRecoilCallback(\n      ({ set }) =>\n        () => {\n          set(transcriptionState, (prevState) => ({\n            ...prevState,\n            error: true,\n            isTranscribing: false,\n          }));\n        },\n      []\n    )\n  );\n  useDailyEvent(\n    'left-meeting',\n    useRecoilCallback(\n      ({ set }) =>\n        () => {\n          set(transcriptionState, (prevState) => ({\n            ...prevState,\n            isTranscribing: false,\n          }));\n        },\n      []\n    )\n  );\n  useDailyEvent(\n    'app-message',\n    useRecoilCallback(\n      ({ set }) =>\n        (ev: DailyEventObjectAppMessage<Transcription>) => {\n          if (ev?.fromId === 'transcription' && ev?.data?.is_final) {\n            set(transcriptionState, (prevState) => ({\n              ...prevState,\n              // setting it to true whenever a new message is received\n              // as the participants who joined after the transcription-started event\n              // won't be knowing if transcription is started or not\n              isTranscribing: true,\n              transcriptions: [...prevState.transcriptions, ev.data],\n            }));\n          }\n        },\n      []\n    )\n  );\n\n  return <>{children}</>;\n};\n","import Daily, { DailyCall, DailyFactoryOptions } from '@daily-co/daily-js';\nimport { useEffect, useRef, useState } from 'react';\n\nimport { customDeepEqual } from '../lib/customDeepEqual';\n\ntype InstanceType = 'callFrame' | 'callObject';\n\nconst defaultOptions: DailyFactoryOptions = {};\nconst defaultShouldCreateInstance = () => true;\n\nexport interface Props {\n  parentEl?: HTMLElement | null;\n  options?: DailyFactoryOptions;\n  shouldCreateInstance?(): boolean;\n}\n\nconst defaultProps: Props = {\n  options: defaultOptions,\n  shouldCreateInstance: defaultShouldCreateInstance,\n};\n\n/**\n * Helper hook to maintain custom call instances in React codebases.\n */\nexport const useCallInstance = (\n  type: InstanceType,\n  {\n    parentEl,\n    options = defaultOptions,\n    shouldCreateInstance = defaultShouldCreateInstance,\n  }: Props = defaultProps\n) => {\n  const [callInstance, setCallInstance] = useState<DailyCall | null>(null);\n\n  /**\n   * Holds last used props when callObject instance was created.\n   */\n  const lastUsedOptions = useRef<DailyFactoryOptions>();\n  useEffect(() => {\n    /**\n     * Call frame instances with a defined parentEl likely pass a ref.\n     * Typically a DOM ref is initialized with useRef(null).\n     * We'll want to wait until parentEl is defined, meaning that the ref is\n     * correctly wired up with a DOM element.\n     * Otherwise we'll just check shouldCreateInstance().\n     */\n    if ((type === 'callFrame' && parentEl === null) || !shouldCreateInstance())\n      return;\n\n    async function destroyCallInstance(co: DailyCall) {\n      await co.destroy();\n    }\n\n    /**\n     * Once instance is destroyed, nullify callInstance, so a new one can be created.\n     */\n    const handleDestroyedInstance = () => {\n      /**\n       * Setting a timeout makes sure the destruction and creation\n       * of call instances happen in separate call stacks.\n       * Otherwise there's a risk for duplicate call instances.\n       */\n      setTimeout(() => setCallInstance(null), 0);\n    };\n\n    let co = Daily.getCallInstance();\n\n    /**\n     * In case a call instance exists outside of this hook instance's knowledge,\n     * store it in state.\n     */\n    if (!callInstance && co && !co.isDestroyed()) {\n      co.once('call-instance-destroyed', handleDestroyedInstance);\n      setCallInstance(co);\n      return;\n    }\n\n    /**\n     * callInstance exists.\n     */\n    if (callInstance) {\n      /**\n       * Props have changed. Destroy current instance, so a new one can be created.\n       */\n      if (!customDeepEqual(lastUsedOptions.current, options)) {\n        destroyCallInstance(callInstance);\n      }\n      /**\n       * Return early.\n       */\n      return;\n    }\n\n    if (!co || co.isDestroyed()) {\n      /**\n       * callInstance doesn't exist or is destroyed (TODO: Check why getCallInstance() can return a destroyed instance),\n       * but should be created.\n       * Important to spread props, because createCallObject/createFrame alters the passed object (adds layout and dailyJsVersion).\n       */\n      switch (type) {\n        case 'callFrame':\n          co = parentEl\n            ? Daily.createFrame(parentEl, { ...options })\n            : Daily.createFrame({ ...options });\n          break;\n        case 'callObject':\n          co = Daily.createCallObject({ ...options });\n          break;\n      }\n      lastUsedOptions.current = options;\n    }\n\n    setCallInstance(co);\n\n    co.once('call-instance-destroyed', handleDestroyedInstance);\n\n    /**\n     * No cleanup phase here, because callObject.destroy() returns a Promise.\n     * We can't have asynchronous cleanups in a useEffect.\n     * To avoid infinite render loops we compare the props when creating call object instances.\n     */\n  }, [callInstance, options, parentEl, shouldCreateInstance, type]);\n\n  return callInstance;\n};\n","import { Props, useCallInstance } from './useCallInstance';\n\ntype CallObjectProps = Omit<Props, 'parentEl'>;\n\n/**\n * Helper hook to maintain custom callObject instances in React codebases.\n */\nexport const useCallObject = (props: CallObjectProps) =>\n  useCallInstance('callObject', props);\n","import {\n  DailyCall,\n  DailyEvent,\n  DailyEventObject,\n  DailyFactoryOptions,\n} from '@daily-co/daily-js';\nimport React, { useCallback, useEffect, useMemo, useRef } from 'react';\nimport { RecoilRoot, RecoilRootProps } from 'recoil';\n\nimport { DailyContext } from './DailyContext';\nimport { DailyDevices } from './DailyDevices';\nimport { DailyEventContext } from './DailyEventContext';\nimport { DailyLiveStreaming } from './DailyLiveStreaming';\nimport { DailyMeeting } from './DailyMeeting';\nimport { DailyNetwork } from './DailyNetwork';\nimport { DailyParticipants } from './DailyParticipants';\nimport { DailyRecordings } from './DailyRecordings';\nimport { DailyRoom } from './DailyRoom';\nimport { DailyTranscriptions } from './DailyTranscriptions';\nimport { useCallObject } from './hooks/useCallObject';\n\ntype BaseProps =\n  | DailyFactoryOptions\n  | {\n      callObject: DailyCall | null;\n    };\n\ntype Props = BaseProps & {\n  /**\n   * Allows to override props for [RecoilRoot](https://recoiljs.org/docs/api-reference/core/RecoilRoot/).\n   * In case you use Recoil in your own application, you can pass `override: false` to allow\n   * daily-react to store its state in your application's RecoilRoot.\n   * Default value: {}\n   */\n  recoilRootProps?: Omit<RecoilRootProps, 'children'>;\n};\n\ntype EventsMap = Partial<Record<DailyEvent, Map<number, Function>>>;\n\nexport const DailyProvider: React.FC<React.PropsWithChildren<Props>> = ({\n  children,\n  recoilRootProps = {},\n  ...props\n}) => {\n  const eventsMap = useRef<EventsMap>({});\n\n  /**\n   * Generic event handler to loop through registered event callbacks.\n   */\n  const handleEvent = useCallback((ev: DailyEventObject) => {\n    if (!('action' in ev)) return;\n    const event = ev.action as DailyEvent;\n    for (let cb of eventsMap.current?.[event]?.values() ?? []) {\n      cb(ev);\n    }\n  }, []);\n\n  /**\n   * In case events are set up via useDailyEvent before a DailyCall instance is available,\n   * we'll register the events whenever daily is set.\n   */\n  const initEventHandlers = useCallback(\n    (daily: DailyCall) => {\n      if (!daily) return;\n      (Object.keys(eventsMap.current) as DailyEvent[]).forEach((event) => {\n        daily.off(event as DailyEvent, handleEvent);\n        if (!daily.isDestroyed()) {\n          daily.on(event as DailyEvent, handleEvent);\n        }\n      });\n    },\n    [handleEvent]\n  );\n\n  const externalCallObject = 'callObject' in props ? props.callObject : null;\n\n  const memoizedOptions = useMemo(\n    () => ('callObject' in props ? {} : props),\n    [props]\n  );\n  const internalCallObject = useCallObject({\n    options: memoizedOptions,\n    shouldCreateInstance: useCallback(() => {\n      return !('callObject' in props);\n    }, [props]),\n  });\n\n  const callObject = externalCallObject ?? internalCallObject;\n\n  useEffect(() => {\n    if (!callObject) return;\n    initEventHandlers(callObject);\n  }, [callObject, initEventHandlers]);\n\n  /**\n   * Registers event callback.\n   */\n  const on = useCallback(\n    (ev: DailyEvent, cb: Function, key: number) => {\n      if (!eventsMap.current[ev]) {\n        eventsMap.current[ev] = new Map();\n        if (callObject) {\n          /**\n           * Make sure only 1 event listener is registered at anytime for handleEvent.\n           * Otherwise, events sent from daily-js might be handled multiple times.\n           */\n          callObject.off(ev, handleEvent);\n          if (!callObject.isDestroyed()) {\n            callObject.on(ev, handleEvent);\n          }\n        }\n      }\n      if (!eventsMap.current[ev]?.has(key)) {\n        eventsMap.current[ev]?.set(key, cb);\n      }\n    },\n    [callObject, handleEvent]\n  );\n\n  /**\n   * Unregisters event callback.\n   */\n  const off = useCallback(\n    (ev: DailyEvent, key: number) => {\n      eventsMap.current[ev]?.delete(key);\n      if (eventsMap.current[ev]?.size === 0) {\n        callObject?.off(ev, handleEvent);\n        delete eventsMap.current[ev];\n      }\n    },\n    [callObject, handleEvent]\n  );\n\n  return (\n    <RecoilRoot {...recoilRootProps}>\n      <DailyContext.Provider value={callObject}>\n        <DailyEventContext.Provider value={{ on, off }}>\n          <DailyRoom>\n            <DailyMeeting>\n              <DailyNetwork>\n                <DailyParticipants>\n                  <DailyRecordings>\n                    <DailyLiveStreaming>\n                      <DailyTranscriptions>\n                        <DailyDevices>{children}</DailyDevices>\n                      </DailyTranscriptions>\n                    </DailyLiveStreaming>\n                  </DailyRecordings>\n                </DailyParticipants>\n              </DailyNetwork>\n            </DailyMeeting>\n          </DailyRoom>\n        </DailyEventContext.Provider>\n      </DailyContext.Provider>\n    </RecoilRoot>\n  );\n};\n","import { DailyEventObject } from '@daily-co/daily-js';\nimport { useCallback, useDebugValue } from 'react';\nimport { useRecoilValue } from 'recoil';\n\nimport { participantState } from '../DailyParticipants';\nimport { useThrottledDailyEvent } from './useThrottledDailyEvent';\n\ninterface UseParticipantArgs {\n  onParticipantLeft?(ev: DailyEventObject<'participant-left'>): void;\n  onParticipantUpdated?(ev: DailyEventObject<'participant-updated'>): void;\n}\n\n/**\n * Returns the participant identified by the given sessionId.\n * @param sessionId  The participant's session_id or \"local\".\n * @deprecated Use [useParticipantProperty](https://docs.daily.co/reference/daily-react/use-participant-property) instead to only subscribe to required participant properties.\n */\nexport const useParticipant = (\n  sessionId: string,\n  { onParticipantLeft, onParticipantUpdated }: UseParticipantArgs = {}\n) => {\n  const participant = useRecoilValue(participantState(sessionId));\n\n  useThrottledDailyEvent(\n    ['participant-updated', 'participant-left'],\n    useCallback(\n      (evts) => {\n        const filteredEvts = evts.filter(\n          (ev) => ev.participant.session_id === sessionId\n        );\n        if (!filteredEvts.length) return;\n        filteredEvts.forEach((ev) => {\n          switch (ev.action) {\n            case 'participant-updated':\n              onParticipantUpdated?.(ev);\n              break;\n            case 'participant-left':\n              onParticipantLeft?.(ev);\n              break;\n          }\n        });\n      },\n      [onParticipantLeft, onParticipantUpdated, sessionId]\n    )\n  );\n\n  useDebugValue(participant);\n\n  return participant;\n};\n","import { DailyEventObject } from '@daily-co/daily-js';\nimport { useCallback, useDebugValue, useEffect, useState } from 'react';\nimport { useRecoilValue } from 'recoil';\n\nimport { activeIdState } from '../DailyParticipants';\nimport { useDaily } from './useDaily';\nimport { useDailyEvent } from './useDailyEvent';\nimport { useParticipant } from './useParticipant';\n\ninterface UseActiveParticipantArgs {\n  /**\n   * If set to true, useActiveParticipant will never return the local participant.\n   */\n  ignoreLocal?: boolean;\n  /**\n   * Optional event callback for [active-speaker-change](https://docs.daily.co/reference/daily-js/events/meeting-events#active-speaker-change) event listener.\n   */\n  onActiveSpeakerChange?(ev: DailyEventObject<'active-speaker-change'>): void;\n}\n\n/**\n * Returns the most recent participant mentioned in an [active-speaker-change](https://docs.daily.co/reference/daily-js/events/meeting-events#active-speaker-change) event.\n * @deprecated Use [useActiveSpeakerId](https://docs.daily.co/reference/daily-react/use-active-speaker-id) instead.\n */\nexport const useActiveParticipant = ({\n  ignoreLocal = false,\n  onActiveSpeakerChange,\n}: UseActiveParticipantArgs = {}) => {\n  const daily = useDaily();\n  const recentActiveId = useRecoilValue(activeIdState);\n  const [activeId, setActiveId] = useState('');\n  const activeParticipant = useParticipant(activeId);\n\n  useEffect(() => {\n    if (!daily) return;\n    const local = daily?.participants()?.local;\n    if (ignoreLocal && recentActiveId === local?.session_id) return;\n\n    // setting activeId as string to avoid passing null to useParticipant hook\n    setActiveId(recentActiveId ?? '');\n  }, [daily, ignoreLocal, recentActiveId]);\n\n  useDailyEvent(\n    'active-speaker-change',\n    useCallback(\n      (ev) => {\n        onActiveSpeakerChange?.(ev);\n      },\n      [onActiveSpeakerChange]\n    )\n  );\n\n  useDebugValue(activeParticipant);\n\n  return activeParticipant;\n};\n","import { DailyEventObjectAppMessage } from '@daily-co/daily-js';\nimport { useCallback } from 'react';\n\nimport { useDaily } from './useDaily';\nimport { useDailyEvent } from './useDailyEvent';\n\ntype SendAppMessage<Data = any> = (data: Data, to?: string) => void;\n\ninterface UseAppMessageArgs<Data> {\n  /**\n   * Optional event callback for [app-message](https://docs.daily.co/reference/daily-js/events/participant-events#app-message) event listener.\n   * Receives this hook's sendAppMessage as an additional argument to avoid circular dependencies.\n   */\n  onAppMessage?(\n    ev: DailyEventObjectAppMessage<Data>,\n    sendAppMessage?: SendAppMessage<Data>\n  ): void;\n}\n\n/**\n * React hook to setup [app-message](https://docs.daily.co/reference/daily-js/events/participant-events#app-message) listeners and\n * to send messages via [sendAppMessage](https://docs.daily.co/reference/daily-js/instance-methods/send-app-message).\n */\nexport const useAppMessage = <Data = any>({\n  onAppMessage,\n}: UseAppMessageArgs<Data> = {}) => {\n  const daily = useDaily();\n\n  const sendAppMessage: SendAppMessage<Data> = useCallback(\n    (data, to = '*') => {\n      if (!daily) return;\n      daily.sendAppMessage(data, to);\n    },\n    [daily]\n  );\n\n  const handleAppMessage = useCallback(\n    (ev: DailyEventObjectAppMessage<Data>) => {\n      onAppMessage?.(ev, sendAppMessage);\n    },\n    [onAppMessage, sendAppMessage]\n  );\n\n  useDailyEvent('app-message', handleAppMessage);\n\n  return sendAppMessage;\n};\n","const audioLevelProcessor = `\n    class AudioLevelProcessor extends AudioWorkletProcessor {\n    volume;\n    interval;\n    nextFrame;\n    \n    constructor() {\n      super();\n      this.volume = 0;\n      this.interval = 25;\n      this.nextFrame = this.interval;\n    }\n    \n    get intervalInFrames() {\n      // sampleRate is globally defined in AudioWorklets.\n      // See https://developer.mozilla.org/en-US/docs/Web/API/AudioWorkletGlobalScope\n      // eslint-disable-next-line no-undef\n      return (this.interval / 1000) * sampleRate;\n    }\n    \n    process(inputList) {\n      const firstInput = inputList[0];\n    \n      if (firstInput.length > 0) {\n        const inputData = firstInput[0];\n        let total = 0;\n    \n        for (let i = 0; i < inputData.length; ++i) {\n          total += Math.abs(inputData[i]);\n        }\n    \n        const rms = Math.sqrt(total / inputData.length);\n        this.volume = Math.max(0, Math.min(1, rms));\n    \n        this.nextFrame -= inputData.length;\n        if (this.nextFrame < 0) {\n          this.nextFrame += this.intervalInFrames;\n          this.port.postMessage({ volume: this.volume });\n        }\n      }\n    \n      return true;\n    }\n    }\n    \n    registerProcessor('audiolevel', AudioLevelProcessor);              \n`;\n\nexport const inlineAudioWorklet = `data:application/javascript;charset=utf8,${encodeURIComponent(\n  audioLevelProcessor\n)}`;\n","import { useEffect, useRef } from 'react';\n\nimport { inlineAudioWorklet } from '../lib/inlineAudioWorklet';\n/**\n * Returns the volume level of a given MediaStreamTrack.\n * @param mediaTrack The MediaStreamTrack to be analysed.\n * @param onVolumeChange The function to execute when the volume changes. Can be used to visualise audio output.\n */\nexport const useAudioLevel = (\n  mediaTrack: MediaStreamTrack | undefined,\n  onVolumeChange: (volume: number) => void\n) => {\n  const audioCtx = useRef<AudioContext>();\n\n  useEffect(\n    function setupStreamAndStartProcessing() {\n      // No mediaTrack. Stop immediately.\n      if (!mediaTrack) return;\n      const AudioCtx =\n        typeof AudioContext !== 'undefined'\n          ? AudioContext\n          : typeof window.webkitAudioContext !== 'undefined'\n          ? window.webkitAudioContext\n          : null;\n      // No AudioContext available in browser. Can't measure audio volume.\n      if (!AudioCtx) return;\n      if (!audioCtx.current) {\n        // No audio context initialized. Initializing now.\n        audioCtx.current = new AudioCtx();\n      }\n      const audioContext = audioCtx.current;\n      // Audio context could not be initialized. Stopping.\n      if (!audioContext) return;\n\n      const mediaStreamSource = audioContext.createMediaStreamSource(\n        new MediaStream([mediaTrack])\n      );\n      let node: AudioWorkletNode | null;\n      let gainNode: GainNode;\n\n      const startProcessing = async () => {\n        /**\n         * Try to add the module only once.\n         * In case it's not added to the audio context, yet, trying to initialize it will fail.\n         * There's only one real reason for `new AudioWorkletNode` to fail and that is\n         * when the corresponding module isn't added to the audio context, yet.\n         * This makes sure we only add the module once.\n         *\n         * We're inlining the worklet instead of loading it via a URL as not to complicate bundling\n         * this package.\n         */\n        try {\n          node = new AudioWorkletNode(audioContext, 'audiolevel');\n          gainNode = audioContext.createGain();\n        } catch {\n          try {\n            await audioContext.audioWorklet.addModule(inlineAudioWorklet);\n            node = new AudioWorkletNode(audioContext, 'audiolevel');\n            gainNode = audioContext.createGain();\n          } catch (e) {\n            console.error(e);\n          }\n        }\n\n        if (!(node && gainNode)) return;\n\n        node.port.onmessage = (event) => {\n          let volume = 0;\n          if (event.data.volume) volume = event.data.volume;\n          if (!node) return;\n          onVolumeChange(volume);\n        };\n\n        gainNode.gain.value = 0;\n\n        try {\n          mediaStreamSource\n            .connect(node)\n            .connect(gainNode)\n            .connect(audioContext.destination);\n        } catch (e) {\n          console.warn(e);\n        }\n      };\n\n      startProcessing();\n\n      return () => {\n        node?.disconnect();\n        node = null;\n        mediaStreamSource?.disconnect();\n      };\n    },\n    [onVolumeChange, mediaTrack]\n  );\n};\n","import { MediaTrackState, useMediaTrack } from './useMediaTrack';\n\n/**\n * Returns a participant's audio track and state.\n * @param participantId The participant's session_id.\n */\nexport const useAudioTrack = (participantId: string): MediaTrackState =>\n  useMediaTrack(participantId, 'audio');\n","import { useCallInstance } from './useCallInstance';\n\ntype Props = Parameters<typeof useCallInstance>[1];\n\n/**\n * Helper hook to maintain custom callFrame instances in React codebases.\n */\nexport const useCallFrame = (props: Props) =>\n  useCallInstance('callFrame', props);\n","import { DailyCpuLoadStats, DailyEventObject } from '@daily-co/daily-js';\nimport deepEqual from 'fast-deep-equal';\nimport { useCallback, useDebugValue, useEffect } from 'react';\nimport { atom, useRecoilCallback, useRecoilValue } from 'recoil';\n\nimport { useDaily } from './useDaily';\nimport { useDailyEvent } from './useDailyEvent';\nimport { useMeetingState } from './useMeetingState';\n\ninterface CPULoad {\n  state: DailyCpuLoadStats['cpuLoadState'];\n  reason: DailyCpuLoadStats['cpuLoadStateReason'];\n}\n\nconst CPULoadState = atom<CPULoad>({\n  key: 'cpu-load-state',\n  default: {\n    state: 'low',\n    reason: 'none',\n  },\n});\n\ninterface Props {\n  onCPULoadChange?(ev: DailyEventObject<'cpu-load-change'>): void;\n}\n\n/**\n * Returns the current CPU load as reported by daily-js [cpu-load-change](https://docs.daily.co/reference/daily-js/events/quality-events#cpu-load-change) events\n * and [getCpuLoadStats](https://docs.daily.co/reference/daily-js/instance-methods/get-cpu-load-stats).\n */\nexport const useCPULoad = ({ onCPULoadChange }: Props = {}) => {\n  const cpu = useRecoilValue(CPULoadState);\n  const daily = useDaily();\n  const meetingState = useMeetingState();\n\n  const updateCPULoadState = useRecoilCallback(\n    ({ set, snapshot }) =>\n      async (cpu: CPULoad) => {\n        const prev = await snapshot.getPromise(CPULoadState);\n        if (deepEqual(prev, cpu)) return;\n        set(CPULoadState, cpu);\n      },\n    []\n  );\n\n  useEffect(() => {\n    let mounted = true;\n    if (!daily || daily.isDestroyed() || meetingState !== 'joined-meeting')\n      return;\n    daily.getCpuLoadStats().then((stats) => {\n      if (!mounted) return;\n      updateCPULoadState({\n        state: stats.cpuLoadState,\n        reason: stats.cpuLoadStateReason,\n      });\n    });\n    return () => {\n      mounted = false;\n    };\n  }, [daily, meetingState, updateCPULoadState]);\n\n  useDailyEvent(\n    'cpu-load-change',\n    useCallback(\n      (ev) => {\n        updateCPULoadState({\n          state: ev.cpuLoadState,\n          reason: ev.cpuLoadStateReason,\n        });\n        onCPULoadChange?.(ev);\n      },\n      [onCPULoadChange, updateCPULoadState]\n    )\n  );\n\n  useDebugValue(cpu);\n\n  return cpu;\n};\n","import { useDebugValue } from 'react';\nimport { useRecoilValue } from 'recoil';\n\nimport { meetingErrorState, nonFatalErrorState } from '../DailyMeeting';\n\n/**\n * Returns a meeting's last known errors.\n */\nexport const useDailyError = () => {\n  const meetingError = useRecoilValue(meetingErrorState);\n  const nonFatalError = useRecoilValue(nonFatalErrorState);\n  const result = {\n    meetingError,\n    nonFatalError,\n  };\n  useDebugValue(result);\n  return result;\n};\n","import { useCallback, useContext, useDebugValue } from 'react';\nimport { useRecoilValue } from 'recoil';\n\nimport {\n  cameraDevicesState,\n  generalCameraState,\n  generalMicrophoneState,\n  lastCameraErrorState,\n  microphoneDevicesState,\n  speakerDevicesState,\n} from '../DailyDevices';\nimport { DailyDevicesContext } from '../DailyDevicesContext';\nimport { useDaily } from './useDaily';\n\n/**\n * This hook allows access to information about the user's devices and their state.\n */\nexport const useDevices = () => {\n  const daily = useDaily();\n\n  const camState = useRecoilValue(generalCameraState);\n  const micState = useRecoilValue(generalMicrophoneState);\n  const camDevices = useRecoilValue(cameraDevicesState);\n  const micDevices = useRecoilValue(microphoneDevicesState);\n  const speakerDevices = useRecoilValue(speakerDevicesState);\n  const cameraError = useRecoilValue(lastCameraErrorState);\n\n  const { refreshDevices } = useContext(DailyDevicesContext);\n\n  /**\n   * Sets video input device to given deviceId.\n   */\n  const setCamera = useCallback(\n    async (deviceId: string) => {\n      await daily?.setInputDevicesAsync({\n        audioDeviceId: null,\n        videoDeviceId: deviceId,\n      });\n    },\n    [daily]\n  );\n\n  /**\n   * Sets audio input device to given deviceId.\n   */\n  const setMicrophone = useCallback(\n    async (deviceId: string) => {\n      await daily?.setInputDevicesAsync({\n        audioDeviceId: deviceId,\n        videoDeviceId: null,\n      });\n    },\n    [daily]\n  );\n\n  /**\n   * Sets audio output device to given deviceId.\n   */\n  const setSpeaker = useCallback(\n    async (deviceId: string) => {\n      await daily?.setOutputDeviceAsync({\n        outputDeviceId: deviceId,\n      });\n    },\n    [daily]\n  );\n\n  const errorStates: typeof camState[] = [\n    'blocked',\n    'in-use',\n    'not-found',\n    'constraints-invalid',\n    'constraints-none-specified',\n    'undefined-mediadevices',\n    'unknown',\n  ];\n\n  const result = {\n    /**\n     * Most recent error object emitted via [camera-error event](https://docs.daily.co/reference/daily-js/events/meeting-events#camera-error).\n     */\n    cameraError,\n    /**\n     * A list of the user's camera (videoinput) devices. See [MediaDeviceInfo](https://developer.mozilla.org/en-US/docs/Web/API/MediaDeviceInfo) for more info.\n     */\n    cameras: camDevices,\n    /**\n     * The general state for camera access.\n     */\n    camState,\n    /**\n     * Holds the currently selected camera.\n     */\n    currentCam: camDevices.find((cam) => cam.selected),\n    /**\n     * Holds the currently selected microphone.\n     */\n    currentMic: micDevices.find((mic) => mic.selected),\n    /**\n     * Holds the currently selected speaker.\n     */\n    currentSpeaker: speakerDevices.find((speaker) => speaker.selected),\n    /**\n     * Indicates that there's an issue with camera devices.\n     */\n    hasCamError: errorStates.includes(camState),\n    /**\n     * Indicates that there's an issue with microphone devices.\n     */\n    hasMicError: errorStates.includes(micState),\n    /**\n     * A list of the user's microphone (audioinput) devices. See [MediaDeviceInfo](https://developer.mozilla.org/en-US/docs/Web/API/MediaDeviceInfo) for more info.\n     */\n    microphones: micDevices,\n    /**\n     * The general state for microphone access.\n     */\n    micState,\n    /**\n     * Refreshes the list of devices using [enumerateDevices](https://docs.daily.co/reference/daily-js/instance-methods/enumerate-devices).\n     */\n    refreshDevices,\n    /**\n     * Allows to switch to the camera with the specified deviceId. Calls [setInputDevicesAsync](https://docs.daily.co/reference/daily-js/instance-methods/set-input-devices-async) internally.\n     */\n    setCamera,\n    /**\n     * Allows to switch to the microphone with the specified deviceId. Calls [setInputDevicesAsync](https://docs.daily.co/reference/daily-js/instance-methods/set-input-devices-async) internally.\n     */\n    setMicrophone,\n    /**\n     * Allows to switch to the speaker with the specified deviceId. Calls [setOutputDevice](https://docs.daily.co/reference/daily-js/instance-methods/set-output-device) internally.\n     */\n    setSpeaker,\n    /**\n     * A list of the user's speaker (audiooutput) devices. See [MediaDeviceInfo](https://developer.mozilla.org/en-US/docs/Web/API/MediaDeviceInfo) for more info.\n     */\n    speakers: speakerDevices,\n  };\n\n  useDebugValue(result);\n\n  return result;\n};\n","import {\n  DailyCall,\n  DailyEventObject,\n  DailyEventObjectNonFatalError,\n  DailyInputSettings,\n} from '@daily-co/daily-js';\nimport { useCallback, useDebugValue, useEffect } from 'react';\nimport { atom, useRecoilCallback, useRecoilValue } from 'recoil';\n\nimport { RECOIL_PREFIX } from '../lib/constants';\nimport { Reconstruct } from '../types/Reconstruct';\nimport { useDaily } from './useDaily';\nimport { useDailyError } from './useDailyError';\nimport { useDailyEvent } from './useDailyEvent';\n\ntype DailyEventObjectInputSettingsError = Reconstruct<\n  DailyEventObjectNonFatalError,\n  'type',\n  'input-settings-error'\n>;\n\ninterface UseInputSettingsArgs {\n  onError?(ev: DailyEventObjectInputSettingsError): void;\n  onInputSettingsUpdated?(ev: DailyEventObject<'input-settings-updated'>): void;\n}\n\nconst inputSettingsState = atom<DailyInputSettings | null>({\n  key: RECOIL_PREFIX + 'input-settings',\n  default: null,\n});\n\nexport const useInputSettings = ({\n  onError,\n  onInputSettingsUpdated,\n}: UseInputSettingsArgs = {}) => {\n  const inputSettings = useRecoilValue(inputSettingsState);\n  const { nonFatalError } = useDailyError();\n  const daily = useDaily();\n\n  const updateInputSettingsState = useRecoilCallback(\n    ({ set }) =>\n      (inputSettings: DailyInputSettings) => {\n        set(inputSettingsState, inputSettings);\n      },\n    []\n  );\n\n  useEffect(() => {\n    if (!daily) return;\n    daily.getInputSettings().then(updateInputSettingsState);\n  }, [daily, updateInputSettingsState]);\n\n  /**\n   * Handle 'input-settings-updated' events.\n   */\n  useDailyEvent(\n    'input-settings-updated',\n    useCallback(\n      (ev) => {\n        updateInputSettingsState(ev.inputSettings);\n        onInputSettingsUpdated?.(ev);\n      },\n      [onInputSettingsUpdated, updateInputSettingsState]\n    )\n  );\n\n  /**\n   * Handle nonfatal errors of type 'input-settings-error'.\n   */\n  useDailyEvent(\n    'nonfatal-error',\n    useCallback(\n      (ev) => {\n        if (ev.type !== 'input-settings-error') return;\n        onError?.(ev as DailyEventObjectInputSettingsError);\n      },\n      [onError]\n    )\n  );\n\n  /**\n   * Calls daily.updateInputSettings internally.\n   */\n  const updateInputSettings = useCallback(\n    (...args: Parameters<DailyCall['updateInputSettings']>) => {\n      return daily?.updateInputSettings(...args);\n    },\n    [daily]\n  );\n\n  const result = {\n    errorMsg:\n      nonFatalError?.type === 'input-settings-error'\n        ? nonFatalError.errorMsg\n        : null,\n    inputSettings,\n    updateInputSettings,\n  };\n\n  useDebugValue(result);\n\n  return result;\n};\n","import {\n  DailyCall,\n  DailyEventObject,\n  DailyEventObjectNonFatalError,\n} from '@daily-co/daily-js';\nimport { useCallback, useDebugValue } from 'react';\nimport { useRecoilValue } from 'recoil';\n\nimport { liveStreamingState } from '../DailyLiveStreaming';\nimport { Reconstruct } from '../types/Reconstruct';\nimport { useDaily } from './useDaily';\nimport { useDailyEvent } from './useDailyEvent';\n\ntype DailyEventObjectLiveStreamingWarning = Reconstruct<\n  DailyEventObjectNonFatalError,\n  'type',\n  'live-streaming-warning'\n>;\n\ninterface UseLiveStreamingArgs {\n  onLiveStreamingStarted?(ev: DailyEventObject<'live-streaming-started'>): void;\n  onLiveStreamingStopped?(ev: DailyEventObject<'live-streaming-stopped'>): void;\n  onLiveStreamingUpdated?(ev: DailyEventObject<'live-streaming-updated'>): void;\n  onLiveStreamingError?(ev: DailyEventObject<'live-streaming-error'>): void;\n  onLiveStreamingWarning?(ev: DailyEventObjectLiveStreamingWarning): void;\n}\n\n/**\n * This hook allows to setup [live streaming events](https://docs.daily.co/reference/daily-js/events/live-streaming-events),\n * as well as starting, stopping and updating live streams.\n *\n * Returns the current live streaming state, incl. the current layout and potential errorMsg.\n */\nexport const useLiveStreaming = ({\n  onLiveStreamingError,\n  onLiveStreamingStarted,\n  onLiveStreamingStopped,\n  onLiveStreamingUpdated,\n  onLiveStreamingWarning,\n}: UseLiveStreamingArgs = {}) => {\n  const daily = useDaily();\n  const state = useRecoilValue(liveStreamingState);\n\n  useDailyEvent(\n    'live-streaming-started',\n    useCallback(\n      (ev) => {\n        onLiveStreamingStarted?.(ev);\n      },\n      [onLiveStreamingStarted]\n    )\n  );\n  useDailyEvent(\n    'live-streaming-stopped',\n    useCallback(\n      (ev) => {\n        onLiveStreamingStopped?.(ev);\n      },\n      [onLiveStreamingStopped]\n    )\n  );\n  useDailyEvent(\n    'live-streaming-updated',\n    useCallback(\n      (ev) => {\n        onLiveStreamingUpdated?.(ev);\n      },\n      [onLiveStreamingUpdated]\n    )\n  );\n  useDailyEvent(\n    'live-streaming-error',\n    useCallback(\n      (ev) => {\n        onLiveStreamingError?.(ev);\n      },\n      [onLiveStreamingError]\n    )\n  );\n  useDailyEvent(\n    'nonfatal-error',\n    useCallback(\n      (ev) => {\n        if (ev.type !== 'live-streaming-warning') return;\n        onLiveStreamingWarning?.(ev as DailyEventObjectLiveStreamingWarning);\n      },\n      [onLiveStreamingWarning]\n    )\n  );\n\n  const startLiveStreaming = useCallback(\n    (...args: Parameters<DailyCall['startLiveStreaming']>) => {\n      if (!daily) return;\n      daily.startLiveStreaming(...args);\n    },\n    [daily]\n  );\n\n  const stopLiveStreaming = useCallback(\n    (...args: Parameters<DailyCall['stopLiveStreaming']>) => {\n      if (!daily) return;\n      daily.stopLiveStreaming(...args);\n    },\n    [daily]\n  );\n\n  const updateLiveStreaming = useCallback(\n    (...args: Parameters<DailyCall['updateLiveStreaming']>) => {\n      if (!daily) return;\n      daily.updateLiveStreaming(...args);\n    },\n    [daily]\n  );\n\n  const result = {\n    ...state,\n    startLiveStreaming,\n    stopLiveStreaming,\n    updateLiveStreaming,\n  };\n\n  useDebugValue(result);\n\n  return result;\n};\n","import { useDebugValue } from 'react';\nimport { useRecoilValue } from 'recoil';\n\nimport { localIdState } from '../DailyParticipants';\nimport { useParticipant } from './useParticipant';\n\n/**\n * Returns the [participants() object](https://docs.daily.co/reference/daily-js/instance-methods/participants) for the local user.\n * @deprecated Use [useLocalSessionId](https://docs.daily.co/reference/daily-react/use-local-session-id) instead.\n */\nexport const useLocalParticipant = (): ReturnType<typeof useParticipant> => {\n  const localId = useRecoilValue(localIdState);\n  const localParticipant = useParticipant(localId);\n  useDebugValue(localParticipant);\n  return localParticipant;\n};\n","import { DailyEventObjectNonFatalError } from '@daily-co/daily-js';\nimport { useCallback, useDebugValue } from 'react';\nimport { useRecoilValue } from 'recoil';\n\nimport { meetingSessionDataState } from '../DailyMeeting';\nimport { Reconstruct } from '../types/Reconstruct';\nimport { useDailyEvent } from './useDailyEvent';\n\ntype DailyEventObjectMeetingSessionDataError = Reconstruct<\n  DailyEventObjectNonFatalError,\n  'type',\n  'meeting-session-data-error'\n>;\n\ninterface Props {\n  onError?(ev: DailyEventObjectMeetingSessionDataError): void;\n}\n\n/**\n * Returns a meeting's current session data and topology.\n */\nexport const useMeetingSessionState = <T = any>({ onError }: Props = {}) => {\n  const meetingSessionState = useRecoilValue(meetingSessionDataState);\n\n  useDailyEvent(\n    'nonfatal-error',\n    useCallback(\n      (ev) => {\n        if (ev.type !== 'meeting-session-data-error') return;\n        onError?.(ev as DailyEventObjectMeetingSessionDataError);\n      },\n      [onError]\n    )\n  );\n\n  const result = {\n    data: meetingSessionState?.data as T,\n    topology: meetingSessionState?.topology,\n  };\n\n  useDebugValue(result);\n\n  return result;\n};\n","import { DailyEventObject } from '@daily-co/daily-js';\nimport { useCallback, useDebugValue } from 'react';\nimport { useRecoilValue } from 'recoil';\n\nimport {\n  networkQualityState,\n  networkThresholdState,\n  topologyState,\n} from '../DailyNetwork';\nimport { useDaily } from './useDaily';\nimport { useDailyEvent } from './useDailyEvent';\n\ninterface UseNetworkArgs {\n  onNetworkConnection?(ev: DailyEventObject<'network-connection'>): void;\n  onNetworkQualityChange?(ev: DailyEventObject<'network-quality-change'>): void;\n}\n\n/**\n * Returns current information about network quality and topology.\n * Allows to setup event listeners for daily's [network events](https://docs.daily.co/reference/daily-js/events/network-events).\n */\nexport const useNetwork = ({\n  onNetworkConnection,\n  onNetworkQualityChange,\n}: UseNetworkArgs = {}) => {\n  const daily = useDaily();\n\n  const topology = useRecoilValue(topologyState);\n  const quality = useRecoilValue(networkQualityState);\n  const threshold = useRecoilValue(networkThresholdState);\n\n  useDailyEvent(\n    'network-connection',\n    useCallback(\n      (ev) => {\n        onNetworkConnection?.(ev);\n      },\n      [onNetworkConnection]\n    )\n  );\n  useDailyEvent(\n    'network-quality-change',\n    useCallback(\n      (ev) => {\n        onNetworkQualityChange?.(ev);\n      },\n      [onNetworkQualityChange]\n    )\n  );\n\n  const getStats = useCallback(async () => {\n    const newStats = await daily?.getNetworkStats();\n    return newStats?.stats;\n  }, [daily]);\n\n  const result = {\n    getStats,\n    quality,\n    threshold,\n    topology,\n  };\n\n  useDebugValue(result);\n\n  return result;\n};\n","import { DailyEventObject, DailyParticipantCounts } from '@daily-co/daily-js';\nimport { useCallback, useDebugValue, useEffect } from 'react';\nimport { atom, useRecoilCallback, useRecoilValue } from 'recoil';\n\nimport { RECOIL_PREFIX } from '../lib/constants';\nimport { useDaily } from './useDaily';\nimport { useDailyEvent } from './useDailyEvent';\n\nconst participantCountsState = atom<DailyParticipantCounts>({\n  key: RECOIL_PREFIX + 'participant-counts',\n  default: {\n    hidden: 0,\n    present: 0,\n  },\n});\n\ninterface Props {\n  onParticipantCountsUpdated?(\n    ev: DailyEventObject<'participant-counts-updated'>\n  ): void;\n}\n\n/**\n * Returns participant counts for hidden and present participants.\n */\nexport const useParticipantCounts = ({\n  onParticipantCountsUpdated,\n}: Props = {}) => {\n  const daily = useDaily();\n  const participantCounts = useRecoilValue(participantCountsState);\n\n  const updateCounts = useRecoilCallback(\n    ({ set }) =>\n      (counts: DailyParticipantCounts) => {\n        set(participantCountsState, counts);\n      },\n    []\n  );\n\n  useDailyEvent(\n    'participant-counts-updated',\n    useCallback(\n      (ev) => {\n        updateCounts(ev.participantCounts);\n        onParticipantCountsUpdated?.(ev);\n      },\n      [onParticipantCountsUpdated, updateCounts]\n    )\n  );\n\n  useEffect(() => {\n    if (!daily || daily.isDestroyed()) return;\n    updateCounts(daily.participantCounts());\n  }, [daily, updateCounts]);\n\n  useDebugValue(participantCounts);\n\n  return participantCounts;\n};\n","import { useDebugValue } from 'react';\n\nimport { useLocalSessionId } from './useLocalSessionId';\nimport { useParticipantProperty } from './useParticipantProperty';\n\n/**\n * Returns parsed permissions for a given participant.\n * In case no `sessionId` is passed, the hook returns permissions for the local participant.\n * @param sessionId The participant's session_id (optional)\n */\nexport const usePermissions = (sessionId?: string) => {\n  const localSessionId = useLocalSessionId();\n  const permissions = useParticipantProperty(\n    sessionId ?? localSessionId,\n    'permissions'\n  );\n\n  const canSendAudio =\n    typeof permissions?.canSend === 'boolean'\n      ? permissions?.canSend\n      : Boolean(permissions?.canSend?.has('audio'));\n  const canSendVideo =\n    typeof permissions?.canSend === 'boolean'\n      ? permissions?.canSend\n      : Boolean(permissions?.canSend?.has('video'));\n  const canSendCustomAudio =\n    typeof permissions?.canSend === 'boolean'\n      ? permissions?.canSend\n      : Boolean(permissions?.canSend?.has('customAudio'));\n  const canSendCustomVideo =\n    typeof permissions?.canSend === 'boolean'\n      ? permissions?.canSend\n      : Boolean(permissions?.canSend?.has('customVideo'));\n  const canSendScreenAudio =\n    typeof permissions?.canSend === 'boolean'\n      ? permissions?.canSend\n      : Boolean(permissions?.canSend?.has('screenAudio'));\n  const canSendScreenVideo =\n    typeof permissions?.canSend === 'boolean'\n      ? permissions?.canSend\n      : Boolean(permissions?.canSend?.has('screenVideo'));\n  const canAdminParticipants =\n    typeof permissions?.canAdmin === 'boolean'\n      ? permissions?.canAdmin\n      : Boolean(permissions?.canAdmin?.has('participants'));\n  const canAdminStreaming =\n    typeof permissions?.canAdmin === 'boolean'\n      ? permissions?.canAdmin\n      : Boolean(permissions?.canAdmin?.has('streaming'));\n  const canAdminTranscription =\n    typeof permissions?.canAdmin === 'boolean'\n      ? permissions?.canAdmin\n      : Boolean(permissions?.canAdmin?.has('transcription'));\n\n  const result = {\n    canAdminParticipants,\n    canAdminStreaming,\n    canAdminTranscription,\n    canSendAudio,\n    canSendCustomAudio,\n    canSendCustomVideo,\n    canSendScreenAudio,\n    canSendScreenVideo,\n    canSendVideo,\n    hasPresence: permissions?.hasPresence,\n    permissions,\n  };\n\n  useDebugValue(result);\n\n  return result;\n};\n","import {\n  DailyCall,\n  DailyEventObject,\n  DailyReceiveSettings,\n  DailySingleParticipantReceiveSettings,\n} from '@daily-co/daily-js';\nimport { useCallback, useDebugValue, useEffect } from 'react';\nimport { atomFamily, useRecoilCallback, useRecoilValue } from 'recoil';\n\nimport { RECOIL_PREFIX } from '../lib/constants';\nimport { useDaily } from './useDaily';\nimport { useDailyEvent } from './useDailyEvent';\nimport { useMeetingState } from './useMeetingState';\n\nconst participantReceiveSettingsState = atomFamily<\n  DailySingleParticipantReceiveSettings,\n  string\n>({\n  key: RECOIL_PREFIX + 'participant-receive-settings',\n  default: {},\n});\n\ninterface UseReceiveSettingsArgs {\n  id?: string;\n  onReceiveSettingsUpdated?(\n    ev: DailyEventObject<'receive-settings-updated'>\n  ): void;\n}\n\n/**\n * Allows to read and set receiveSettings.\n * In case receiveSettings for participant specified by id are empty, not set or 'inherit',\n * base receiveSettings will be returned.\n * In case meeting is not in joined state, calls to updateReceiveSettings will be silently ignored.\n */\nexport const useReceiveSettings = ({\n  id = 'base',\n  onReceiveSettingsUpdated,\n}: UseReceiveSettingsArgs = {}) => {\n  const baseSettings = useRecoilValue(participantReceiveSettingsState('base'));\n  const receiveSettings = useRecoilValue(participantReceiveSettingsState(id));\n  const daily = useDaily();\n  const meetingState = useMeetingState();\n\n  const updateReceiveSettingsState = useRecoilCallback(\n    ({ transact_UNSTABLE }) =>\n      (receiveSettings: DailyReceiveSettings) => {\n        transact_UNSTABLE(({ reset, set }) => {\n          const { ...ids } = receiveSettings;\n          for (let [id, settings] of Object.entries(ids)) {\n            set(participantReceiveSettingsState(id), settings);\n          }\n          if (!(id in ids)) {\n            reset(participantReceiveSettingsState(id));\n          }\n        });\n      },\n    [id]\n  );\n  useDailyEvent(\n    'receive-settings-updated',\n    useCallback(\n      (ev) => {\n        updateReceiveSettingsState(ev.receiveSettings);\n        onReceiveSettingsUpdated?.(ev);\n      },\n      [onReceiveSettingsUpdated, updateReceiveSettingsState]\n    )\n  );\n\n  useEffect(() => {\n    if (!daily || daily.isDestroyed()) return;\n    daily.getReceiveSettings().then(updateReceiveSettingsState);\n  }, [daily, updateReceiveSettingsState]);\n\n  const updateReceiveSettings = useCallback(\n    (...args: Parameters<DailyCall['updateReceiveSettings']>) => {\n      if (!daily || meetingState !== 'joined-meeting') return;\n      daily?.updateReceiveSettings?.(...args);\n    },\n    [daily, meetingState]\n  );\n\n  const result = {\n    receiveSettings:\n      id === 'base' || Object.keys(receiveSettings).length === 0\n        ? baseSettings\n        : receiveSettings,\n    updateReceiveSettings,\n  };\n\n  useDebugValue(result);\n\n  return result;\n};\n","import { DailyCall, DailyEventObject } from '@daily-co/daily-js';\nimport { useCallback, useDebugValue } from 'react';\nimport { useRecoilValue } from 'recoil';\n\nimport { recordingState } from '../DailyRecordings';\nimport { useDaily } from './useDaily';\nimport { useDailyEvent } from './useDailyEvent';\n\ninterface UseRecordingArgs {\n  onRecordingData?(ev: DailyEventObject<'recording-data'>): void;\n  onRecordingError?(ev: DailyEventObject<'recording-error'>): void;\n  onRecordingStarted?(ev: DailyEventObject<'recording-started'>): void;\n  onRecordingStopped?(ev: DailyEventObject<'recording-stopped'>): void;\n}\n\nexport const useRecording = ({\n  onRecordingData,\n  onRecordingError,\n  onRecordingStarted,\n  onRecordingStopped,\n}: UseRecordingArgs = {}) => {\n  const daily = useDaily();\n  const state = useRecoilValue(recordingState);\n\n  useDailyEvent(\n    'recording-started',\n    useCallback(\n      (ev) => {\n        onRecordingStarted?.(ev);\n      },\n      [onRecordingStarted]\n    )\n  );\n  useDailyEvent(\n    'recording-stopped',\n    useCallback(\n      (ev) => {\n        onRecordingStopped?.(ev);\n      },\n      [onRecordingStopped]\n    )\n  );\n  useDailyEvent(\n    'recording-error',\n    useCallback(\n      (ev) => {\n        onRecordingError?.(ev);\n      },\n      [onRecordingError]\n    )\n  );\n  useDailyEvent(\n    'recording-data',\n    useCallback(\n      (ev) => {\n        onRecordingData?.(ev);\n      },\n      [onRecordingData]\n    )\n  );\n\n  /**\n   * Starts the recording with the given optional options.\n   */\n  const startRecording = useCallback(\n    (...args: Parameters<DailyCall['startRecording']>) => {\n      if (!daily) return;\n      daily.startRecording(...args);\n    },\n    [daily]\n  );\n\n  /**\n   * Stops a recording.\n   */\n  const stopRecording = useCallback(\n    (...args: Parameters<DailyCall['stopRecording']>) => {\n      if (!daily) return;\n      daily.stopRecording(...args);\n    },\n    [daily]\n  );\n\n  /**\n   * Updates a running recording's layout configuration.\n   */\n  const updateRecording = useCallback(\n    (...args: Parameters<DailyCall['updateRecording']>) => {\n      if (!daily) return;\n      daily.updateRecording(...args);\n    },\n    [daily]\n  );\n\n  const result = {\n    ...state,\n    startRecording,\n    stopRecording,\n    updateRecording,\n  };\n\n  useDebugValue(result);\n\n  return result;\n};\n","import { DailyRoomInfo } from '@daily-co/daily-js';\nimport { useDebugValue } from 'react';\nimport { useRecoilValue } from 'recoil';\n\nimport { roomState } from '../DailyRoom';\n\n/**\n * Stateful hook to work with room, domain and token configuration for a daily room.\n * Includes room default values.\n */\nexport const useRoom = (): DailyRoomInfo | null => {\n  const room = useRecoilValue(roomState);\n  useDebugValue(room);\n  return room;\n};\n","import { useDebugValue, useEffect, useState } from 'react';\nimport { useRecoilValue } from 'recoil';\n\nimport { localJoinDateState } from '../DailyParticipants';\nimport { useRoom } from './useRoom';\n\ninterface Countdown {\n  hours: number;\n  minutes: number;\n  seconds: number;\n}\n\ninterface Props {\n  onCountdown?(countdown: Countdown): void;\n}\n\nexport const useRoomExp = ({ onCountdown }: Props = {}) => {\n  const localJoinDate = useRecoilValue(localJoinDateState);\n  const room = useRoom();\n\n  const [ejectDate, setEjectDate] = useState<Date | null>(null);\n\n  useEffect(() => {\n    const ejectAfterElapsed =\n      room?.tokenConfig?.eject_after_elapsed ??\n      room?.config?.eject_after_elapsed ??\n      0;\n    const expUTCTimeStamp = room?.tokenConfig?.exp ?? room?.config?.exp ?? 0;\n    const ejectAtExp =\n      room?.tokenConfig?.eject_at_token_exp ??\n      room?.config?.eject_at_room_exp ??\n      false;\n\n    let newEjectDate: Date = new Date(0);\n\n    if (ejectAfterElapsed && localJoinDate) {\n      newEjectDate = new Date(\n        localJoinDate.getTime() + 1000 * ejectAfterElapsed\n      );\n    }\n\n    if (ejectAtExp && expUTCTimeStamp) {\n      const expDate = new Date(expUTCTimeStamp * 1000);\n      if (\n        !newEjectDate.getTime() ||\n        (newEjectDate.getTime() > 0 && expDate < newEjectDate)\n      )\n        newEjectDate = expDate;\n    }\n\n    if (newEjectDate.getTime() === 0) return;\n\n    setEjectDate((oldEjectDate) =>\n      oldEjectDate?.getTime() !== newEjectDate.getTime()\n        ? newEjectDate\n        : oldEjectDate\n    );\n  }, [\n    localJoinDate,\n    room?.config?.eject_after_elapsed,\n    room?.config?.eject_at_room_exp,\n    room?.config?.exp,\n    room?.tokenConfig?.eject_after_elapsed,\n    room?.tokenConfig?.eject_at_token_exp,\n    room?.tokenConfig?.exp,\n  ]);\n\n  useEffect(() => {\n    if (!ejectDate || ejectDate.getTime() === 0) return;\n\n    const interval = setInterval(() => {\n      const eject = (ejectDate?.getTime() ?? 0) / 1000;\n      const now = Date.now() / 1000;\n      const diff = eject - now;\n      if (diff < 0) return;\n      const hours = Math.max(0, Math.floor(diff / 3600));\n      const minutes = Math.max(0, Math.floor((diff % 3600) / 60));\n      const seconds = Math.max(0, Math.floor(diff % 60));\n      onCountdown?.({\n        hours,\n        minutes,\n        seconds,\n      });\n    }, 1000);\n    return () => {\n      clearInterval(interval);\n    };\n  }, [ejectDate, onCountdown]);\n\n  const result = {\n    ejectDate,\n  };\n\n  useDebugValue(result);\n\n  return result;\n};\n","import { MediaTrackState, useMediaTrack } from './useMediaTrack';\n\n/**\n * Returns a participant's screenAudio track and state.\n * @param participantId The participant's session_id.\n */\nexport const useScreenAudioTrack = (participantId: string): MediaTrackState =>\n  useMediaTrack(participantId, 'screenAudio');\n","import { MediaTrackState, useMediaTrack } from './useMediaTrack';\n\n/**\n * Returns a participant's screenVideo track and state.\n * @param participantId The participant's session_id.\n */\nexport const useScreenVideoTrack = (participantId: string): MediaTrackState =>\n  useMediaTrack(participantId, 'screenVideo');\n","import {\n  DailyCall,\n  DailyEventObject,\n  DailySendSettings,\n} from '@daily-co/daily-js';\nimport { useCallback, useDebugValue, useEffect } from 'react';\nimport { atom, useRecoilCallback, useRecoilValue } from 'recoil';\n\nimport { RECOIL_PREFIX } from '../lib/constants';\nimport { useDaily } from './useDaily';\nimport { useDailyEvent } from './useDailyEvent';\n\nconst sendSettingsState = atom<DailySendSettings | null>({\n  key: RECOIL_PREFIX + 'send-settings',\n  default: null,\n});\n\ninterface Props {\n  onSendSettingsUpdated?(ev: DailyEventObject<'send-settings-updated'>): void;\n}\n\n/**\n * Returns the current media send settings and an updater function to change the settings.\n */\nexport const useSendSettings = ({ onSendSettingsUpdated }: Props = {}) => {\n  const daily = useDaily();\n  const sendSettings = useRecoilValue(sendSettingsState);\n\n  useDailyEvent(\n    'send-settings-updated',\n    useRecoilCallback(\n      ({ set }) =>\n        (ev) => {\n          set(sendSettingsState, ev.sendSettings);\n          onSendSettingsUpdated?.(ev);\n        },\n      [onSendSettingsUpdated]\n    )\n  );\n\n  const storeSendSettings = useRecoilCallback(\n    ({ set }) =>\n      (sendSettings: DailySendSettings | null) => {\n        set(sendSettingsState, sendSettings);\n      },\n    []\n  );\n\n  useEffect(() => {\n    if (!daily || daily.isDestroyed()) return;\n    storeSendSettings(daily.getSendSettings());\n  }, [daily, storeSendSettings]);\n\n  /**\n   * Updates the local clients send settings.\n   * See https://docs.daily.co/reference/daily-js/instance-methods/update-send-settings for details.\n   */\n  const updateSendSettings = useCallback(\n    async (...args: Parameters<DailyCall['updateSendSettings']>) => {\n      const newSendSettings = await daily?.updateSendSettings(...args);\n      if (!newSendSettings) return;\n      storeSendSettings(newSendSettings);\n      return newSendSettings;\n    },\n    [daily, storeSendSettings]\n  );\n\n  const result = {\n    sendSettings,\n    updateSendSettings,\n  };\n\n  useDebugValue(result);\n\n  return result;\n};\n","import {\n  DailyCall,\n  DailyEventObject,\n  DailyEventObjectAppMessage,\n} from '@daily-co/daily-js';\nimport { useCallback, useDebugValue } from 'react';\nimport { useRecoilValue } from 'recoil';\n\nimport { Transcription, transcriptionState } from '../DailyTranscriptions';\nimport { useDaily } from './useDaily';\nimport { useDailyEvent } from './useDailyEvent';\n\ninterface UseTranscriptionArgs {\n  onTranscriptionStarted?(ev: DailyEventObject<'transcription-started'>): void;\n  onTranscriptionStopped?(ev: DailyEventObject<'transcription-stopped'>): void;\n  onTranscriptionError?(ev: DailyEventObject<'transcription-error'>): void;\n  onTranscriptionAppData?(ev: DailyEventObjectAppMessage<Transcription>): void;\n}\n\nexport const useTranscription = ({\n  onTranscriptionAppData,\n  onTranscriptionError,\n  onTranscriptionStarted,\n  onTranscriptionStopped,\n}: UseTranscriptionArgs = {}) => {\n  const daily = useDaily();\n\n  const state = useRecoilValue(transcriptionState);\n\n  useDailyEvent(\n    'transcription-started',\n    useCallback(\n      (ev) => {\n        onTranscriptionStarted?.(ev);\n      },\n      [onTranscriptionStarted]\n    )\n  );\n  useDailyEvent(\n    'transcription-stopped',\n    useCallback(\n      (ev) => {\n        onTranscriptionStopped?.(ev);\n      },\n      [onTranscriptionStopped]\n    )\n  );\n  useDailyEvent(\n    'transcription-error',\n    useCallback(\n      (ev) => {\n        onTranscriptionError?.(ev);\n      },\n      [onTranscriptionError]\n    )\n  );\n  useDailyEvent(\n    'app-message',\n    useCallback(\n      (ev: DailyEventObjectAppMessage<Transcription>) => {\n        if (ev?.fromId === 'transcription' && ev?.data?.is_final) {\n          onTranscriptionAppData?.(ev);\n        }\n      },\n      [onTranscriptionAppData]\n    )\n  );\n\n  /**\n   * Starts the transcription with the given optional options.\n   */\n  const startTranscription = useCallback(\n    (...args: Parameters<DailyCall['startTranscription']>) => {\n      if (!daily) return;\n      daily.startTranscription(...args);\n    },\n    [daily]\n  );\n\n  /**\n   * Stops a transcription.\n   */\n  const stopTranscription = useCallback(\n    (...args: Parameters<DailyCall['stopTranscription']>) => {\n      if (!daily) return;\n      daily.stopTranscription(...args);\n    },\n    [daily]\n  );\n\n  const result = {\n    ...state,\n    startTranscription,\n    stopTranscription,\n  };\n\n  useDebugValue(result);\n\n  return result;\n};\n","import { MediaTrackState, useMediaTrack } from './useMediaTrack';\n\n/**\n * Returns a participant's video track and state.\n * @param participantId The participant's session_id.\n */\nexport const useVideoTrack = (participantId: string): MediaTrackState =>\n  useMediaTrack(participantId, 'video');\n","import { DailyEventObject } from '@daily-co/daily-js';\nimport { useCallback, useDebugValue } from 'react';\nimport { useRecoilValue } from 'recoil';\n\nimport { allWaitingParticipantsSelector } from '../DailyParticipants';\nimport { useDaily } from './useDaily';\nimport { useDailyEvent } from './useDailyEvent';\n\ninterface UseWaitingParticipantsArgs {\n  onWaitingParticipantAdded?(\n    ev: DailyEventObject<'waiting-participant-added'>\n  ): void;\n  onWaitingParticipantUpdated?(\n    ev: DailyEventObject<'waiting-participant-updated'>\n  ): void;\n  onWaitingParticipantRemoved?(\n    ev: DailyEventObject<'waiting-participant-removed'>\n  ): void;\n}\n\n/**\n * Hook to access and manage waiting participants.\n */\nexport const useWaitingParticipants = ({\n  onWaitingParticipantAdded,\n  onWaitingParticipantRemoved,\n  onWaitingParticipantUpdated,\n}: UseWaitingParticipantsArgs = {}) => {\n  const daily = useDaily();\n\n  const waitingParticipants = useRecoilValue(allWaitingParticipantsSelector);\n\n  useDailyEvent(\n    'waiting-participant-added',\n    useCallback(\n      (ev) => {\n        onWaitingParticipantAdded?.(ev);\n      },\n      [onWaitingParticipantAdded]\n    )\n  );\n  useDailyEvent(\n    'waiting-participant-removed',\n    useCallback(\n      (ev) => {\n        onWaitingParticipantRemoved?.(ev);\n      },\n      [onWaitingParticipantRemoved]\n    )\n  );\n  useDailyEvent(\n    'waiting-participant-updated',\n    useCallback(\n      (ev) => {\n        onWaitingParticipantUpdated?.(ev);\n      },\n      [onWaitingParticipantUpdated]\n    )\n  );\n\n  const updateWaitingParticipantAccess = useCallback(\n    (id: '*' | string, grantRequestedAccess: boolean) => {\n      if (id === '*') {\n        daily?.updateWaitingParticipants({\n          '*': {\n            grantRequestedAccess,\n          },\n        });\n        return;\n      }\n      daily?.updateWaitingParticipant(id, {\n        grantRequestedAccess,\n      });\n    },\n    [daily]\n  );\n\n  const grantAccess = useCallback(\n    (id: '*' | string) => {\n      updateWaitingParticipantAccess(id, true);\n    },\n    [updateWaitingParticipantAccess]\n  );\n\n  const denyAccess = useCallback(\n    (id: '*' | string) => {\n      updateWaitingParticipantAccess(id, false);\n    },\n    [updateWaitingParticipantAccess]\n  );\n\n  const result = {\n    waitingParticipants,\n    grantAccess,\n    denyAccess,\n  };\n\n  useDebugValue(result);\n\n  return result;\n};\n"],"names":["DailyContext","createContext","useDaily","daily","useContext","useDebugValue","DailyEventContext","on","off","uniqueCounter","getUnique","useDailyEvent","ev","callback","useState","isBlocked","setIsBlocked","reassignCount","useRef","eventId","useMemo","useEffect","current","console","error","timeout","setTimeout","clearTimeout","event","RECOIL_PREFIX","participantPropertyPathsState","atomFamily","key","participantPropertyState","dangerouslyAllowMutability","participantPropertiesState","selectorFamily","get","id","properties","map","path","property","useParticipantProperty","participantId","propertyPaths","useRecoilValue","Array","isArray","reduce","o","i","useThrottledDailyEvent","throttleTimeout","r","e","throttledEvents","useCallback","length","emitEvents","throttle","trailing","addEvent","push","forEach","customDeepEqual","a","b","MediaStream","active","getTracks","every","track","idx","MediaStreamTrack","kind","readyState","Date","getTime","RegExp","source","flags","Set","size","values","value","has","Map","entries","keysA","Object","keys","keysB","equalSelector","options","inner","selector","prior","latest","equals","equalSelectorFamily","priorValues","param","set","getPaths","currentPath","paths","prototype","hasOwnProperty","call","newPath","getParticipantPaths","p","resolvePath","participant","String","split","filter","resolveParticipantPaths","activeIdState","atom","localIdState","localJoinDateState","participantIdsState","participantState","waitingParticipantsState","waitingParticipantState","awaitingAccess","level","name","allWaitingParticipantsSelector","ids","DailyParticipants","children","initialized","setInitialized","initParticipants","useRecoilCallback","transact_UNSTABLE","participants","local","session_id","participantsArray","interval","setInterval","clearInterval","handleInitEvent","evts","reset","action","activeSpeaker","peerId","prev","last_active","prevIds","includes","prevId","oldPaths","wps","wp","React","useLocalSessionId","localId","noopFilter","useActiveSpeakerId","ignoreLocal","localSessionId","recentActiveId","isIgnoredLocalId","isFilteredOut","isRecentIdRelevant","activeId","setActiveId","isTrackOff","trackState","participantIdsFilteredAndSortedState","sort","screenAudioState","screenVideoState","idA","idB","aSort","bSort","undefined","useParticipantIds","onActiveSpeakerChange","onParticipantJoined","onParticipantLeft","onParticipantUpdated","preFilteredSortedIds","getCustomFilteredIds","snapshot","getLoadable","contents","Boolean","customIds","setCustomIds","maybeUpdateCustomIds","newIds","result","screenSharesState","screenIds","screenAudio","screenVideo","screenId","useScreenShare","onError","onLocalScreenShareStarted","onLocalScreenShareStopped","startScreenShare","args","stopScreenShare","type","screens","isSharingScreen","some","s","useMediaTrack","isOff","state","persistentTrack","subscribed","useMergedRef","refs","element","ref","DailyAudioTrack","memo","forwardRef","onPlayFailed","sessionId","props","audioEl","audio","audioRef","subscribedState","audioTag","playTimeout","handleCanPlay","play","target","message","handlePlay","addEventListener","srcObject","removeEventListener","autoPlay","playsInline","displayName","DailyAudio","autoSubscribeActiveSpeaker","maxSpeakers","playLocalScreenAudio","fill","speakers","setSpeakers","activeSpeakerId","containerRef","useImperativeHandle","getActiveSpeakerAudio","querySelector","getAllAudio","from","querySelectorAll","getAudioBySessionId","getRmpAudio","getScreenAudio","getRmpAudioBySessionId","getScreenAudioBySessionId","assignSpeaker","subscribedParticipants","tracks","isSubscribed","isDestroyed","subscribeToTracksAutomatically","updateParticipant","setSubscribedTracks","prevSpeakers","freeSlotCheck","findIndex","mutedIdx","speakerObjects","lastActiveA","lastActiveB","replaceIdx","indexOf","removeSpeaker","newSpeakers","rmpAudioIds","rmpAudio","screen","DailyVideo","automirror","fit","mirror","onResize","playableStyle","style","isLocal","isScreen","isLocalCam","videoEl","videoRef","videoState","videoTrack","isPlayable","isMirrored","videoTrackSettings","getSettings","isUsersFrontCamera","facingMode","setupVideoEvents","video","playVideo","promise","then","controls","warn","paused","handleEnterPIP","transform","handleLeavePIP","handleVisibilityChange","document","visibilityState","updateSrcObject","load","reportVideoDimensions","frame","handleResize","cancelAnimationFrame","requestAnimationFrame","hidden","videoWidth","videoHeight","aspectRatio","height","width","muted","objectFit","DailyDevicesContext","refreshDevices","Promise","resolve","generalCameraState","generalMicrophoneState","cameraDevicesState","microphoneDevicesState","speakerDevicesState","lastCameraErrorState","DailyDevices","navigator","mediaDevices","getUserMedia","enumerateDevices","devices","cams","d","deviceId","mics","getInputDevices","camera","mic","speaker","mapDevice","device","prevDevices","selected","find","sortDeviceByLabel","label","prevCams","prevMics","updateDeviceStates","currentCamState","getPromise","currentMicState","camPermissionState","micPermissionState","permissions","camPermission","query","micPermission","awaitingCamAccess","initialCamOff","byUser","awaitingMicAccess","initialMicOff","blocked","byDeviceInUse","m","byDeviceMissing","byPermissions","missingMedia","blockedMedia","reason","Provider","liveStreamingState","errorMsg","isLiveStreaming","layout","DailyLiveStreaming","prevState","meetingStateState","meetingErrorState","nonFatalErrorState","meetingSessionDataState","data","topology","DailyMeeting","updateMeetingState","meetingState","initMeetingSessionState","meetingSessionState","topologyState","networkQualityState","networkThresholdState","DailyNetwork","initTopology","getNetworkTopology","prevQuality","quality","prevThreshold","threshold","recordingState","isLocalParticipantRecorded","isRecording","DailyRecordings","setState","useSetRecoilState","recordingParticipantIds","hasRecordingParticipants","isLocalParticipantRecording","preset","recordingId","recordingStartedDate","startedBy","useMeetingState","roomState","DailyRoom","updateRoom","room","transcriptionState","isTranscribing","model","language","transcriptions","DailyTranscriptions","transcriptionStartDate","updatedBy","fromId","is_final","defaultOptions","defaultShouldCreateInstance","defaultProps","shouldCreateInstance","useCallInstance","parentEl","callInstance","setCallInstance","lastUsedOptions","destroyCallInstance","co","destroy","handleDestroyedInstance","Daily","getCallInstance","once","createFrame","createCallObject","useCallObject","DailyProvider","recoilRootProps","eventsMap","handleEvent","cb","initEventHandlers","externalCallObject","callObject","memoizedOptions","internalCallObject","RecoilRoot","useParticipant","filteredEvts","useActiveParticipant","activeParticipant","useAppMessage","onAppMessage","sendAppMessage","to","handleAppMessage","audioLevelProcessor","inlineAudioWorklet","encodeURIComponent","useAudioLevel","mediaTrack","onVolumeChange","audioCtx","setupStreamAndStartProcessing","AudioCtx","AudioContext","window","webkitAudioContext","audioContext","mediaStreamSource","createMediaStreamSource","node","gainNode","startProcessing","AudioWorkletNode","createGain","audioWorklet","addModule","port","onmessage","volume","gain","connect","destination","disconnect","useAudioTrack","useCallFrame","CPULoadState","useCPULoad","onCPULoadChange","cpu","updateCPULoadState","deepEqual","mounted","getCpuLoadStats","stats","cpuLoadState","cpuLoadStateReason","useDailyError","meetingError","nonFatalError","useDevices","camState","micState","camDevices","micDevices","speakerDevices","cameraError","setCamera","setInputDevicesAsync","audioDeviceId","videoDeviceId","setMicrophone","setSpeaker","setOutputDeviceAsync","outputDeviceId","errorStates","cameras","currentCam","cam","currentMic","currentSpeaker","hasCamError","hasMicError","microphones","inputSettingsState","useInputSettings","onInputSettingsUpdated","inputSettings","updateInputSettingsState","getInputSettings","updateInputSettings","useLiveStreaming","onLiveStreamingError","onLiveStreamingStarted","onLiveStreamingStopped","onLiveStreamingUpdated","onLiveStreamingWarning","startLiveStreaming","stopLiveStreaming","updateLiveStreaming","useLocalParticipant","localParticipant","useMeetingSessionState","useNetwork","onNetworkConnection","onNetworkQualityChange","getStats","newStats","getNetworkStats","participantCountsState","present","useParticipantCounts","onParticipantCountsUpdated","participantCounts","updateCounts","counts","usePermissions","canSendAudio","canSend","canSendVideo","canSendCustomAudio","canSendCustomVideo","canSendScreenAudio","canSendScreenVideo","canAdminParticipants","canAdmin","canAdminStreaming","canAdminTranscription","hasPresence","participantReceiveSettingsState","useReceiveSettings","onReceiveSettingsUpdated","baseSettings","receiveSettings","updateReceiveSettingsState","settings","getReceiveSettings","updateReceiveSettings","useRecording","onRecordingData","onRecordingError","onRecordingStarted","onRecordingStopped","startRecording","stopRecording","updateRecording","useRoom","useRoomExp","onCountdown","localJoinDate","ejectDate","setEjectDate","ejectAfterElapsed","tokenConfig","eject_after_elapsed","config","expUTCTimeStamp","exp","ejectAtExp","eject_at_token_exp","eject_at_room_exp","newEjectDate","expDate","oldEjectDate","eject","now","diff","hours","Math","max","floor","minutes","seconds","useScreenAudioTrack","useScreenVideoTrack","sendSettingsState","useSendSettings","onSendSettingsUpdated","sendSettings","storeSendSettings","getSendSettings","updateSendSettings","newSendSettings","useTranscription","onTranscriptionAppData","onTranscriptionError","onTranscriptionStarted","onTranscriptionStopped","startTranscription","stopTranscription","useVideoTrack","useWaitingParticipants","onWaitingParticipantAdded","onWaitingParticipantRemoved","onWaitingParticipantUpdated","waitingParticipants","updateWaitingParticipantAccess","grantRequestedAccess","updateWaitingParticipants","updateWaitingParticipant","grantAccess","denyAccess"],"mappings":"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"}